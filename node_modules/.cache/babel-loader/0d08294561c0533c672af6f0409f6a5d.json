{"ast":null,"code":"import _asyncToGenerator from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import Select from'react-select';import{url}from'src/helpers/helpers';import{toast,ToastContainer}from'react-toastify';import{userContext}from'../../context/UserContext';import{formatDate}from'../../helpers/helpers';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function DetailCustomerReport(){var _React$useContext=React.useContext(userContext),user=_React$useContext.user,setLoad=_React$useContext.setLoad;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),customerDetailList=_React$useState2[0],setCustomerDetailList=_React$useState2[1];var _React$useState3=React.useState(new Date()),_React$useState4=_slicedToArray(_React$useState3,2),from_Date=_React$useState4[0],setFromDate=_React$useState4[1];var _React$useState5=React.useState(new Date()),_React$useState6=_slicedToArray(_React$useState5,2),to_Date=_React$useState6[0],setToDate=_React$useState6[1];var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),currentCustomer=_React$useState8[0],setCurrentCustomer=_React$useState8[1];var _React$useState9=React.useState(0),_React$useState10=_slicedToArray(_React$useState9,2),totalAmount=_React$useState10[0],settotalAmount=_React$useState10[1];var _React$useState11=React.useState(0),_React$useState12=_slicedToArray(_React$useState11,2),dueAmount=_React$useState12[0],setDueAmount=_React$useState12[1];var _React$useState13=React.useState([]),_React$useState14=_slicedToArray(_React$useState13,2),paymentlist=_React$useState14[0],setPaymentList=_React$useState14[1];var _React$useState15=React.useState([]),_React$useState16=_slicedToArray(_React$useState15,2),allCustomers=_React$useState16[0],setAllCustomers=_React$useState16[1];var index=0;var index1=0;React.useEffect(function(){setLoad(true);function fetchCustomers(){return _fetchCustomers.apply(this,arguments);}function _fetchCustomers(){_fetchCustomers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(url+'clientlist',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context.sent;if(!(response.ok===true)){_context.next=9;break;}_context.next=6;return response.json();case 6:data=_context.sent;setLoad(false);if(data.status===200){setAllCustomers(data===null||data===void 0?void 0:data.client_list.map(function(item){return{value:item.id,label:item.name,normal:item.normal,star:item.star,vinyl:item.vinyl,one_way:item.one_way,backlit:item.backlit,premium:item.premium,card12_18:item.card_12_18,sticker12_18:item.sticker_12_18,due_amount:item.due_amount};}));}else{toast.error(data.message);}case 9:case\"end\":return _context.stop();}}},_callee);}));return _fetchCustomers.apply(this,arguments);}fetchCustomers();},[]);function handleSubmit(){if(to_Date&&from_Date&&currentCustomer){var submit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(url+'detailCustomerReport',{method:'POST',headers:{'Authorization':user===null||user===void 0?void 0:user.token},body:formData});case 2:response=_context2.sent;if(!(response.ok===true)){_context2.next=11;break;}_context2.next=6;return response.json();case 6:data=_context2.sent;setLoad(false);if(data.status===200){settotalAmount(parseFloat(data.total_amount).toFixed(2));setCustomerDetailList(data.customer_detail);setDueAmount(data.due_amount);console.log(data.payment_list);setPaymentList(data.payment_list);}else{toast.error(data.message);}_context2.next=12;break;case 11:toast.error('Oops something went wrong!');case 12:case\"end\":return _context2.stop();}}},_callee2);}));return function submit(){return _ref.apply(this,arguments);};}();setLoad(true);var formData=new FormData();formData.append('to',to_Date);formData.append('from',from_Date);formData.append('customer',JSON.stringify(currentCustomer));submit().catch(function(err){return toast.error('Internal server error!. Please try again later');});}else{toast.error('Please fill the to and from date');}}function exportPDF(){var html=document.getElementById('export-table').innerHTML;var myWindow=window.open('','Receipt');myWindow.document.write('<html><head><title>Receipt</title>');myWindow.document.write('<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css\" integrity=\"sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn\" crossorigin=\"anonymous\">');myWindow.document.write(\"</head><body>\");myWindow.document.write(html);myWindow.document.write('</body></html>');myWindow.document.close();myWindow.onload=function(){myWindow.focus();myWindow.print();};}return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsxs(\"div\",{class:\"d-flex\",children:[/*#__PURE__*/_jsx(\"form\",{class:\"col-md-10 m-0 p-0\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"form-row m-0 p-0 create-purchase-header\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"date\",children:[\"From\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{value:from_Date,onChange:function onChange(e){return setFromDate(e.target.value);},type:\"date\",class:\"form-control\",id:\"date\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"date\",children:[\"To\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{value:to_Date,onChange:function onChange(e){return setToDate(e.target.value);},type:\"date\",class:\"form-control\",id:\"date\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"input-customer\",children:[\"Customer\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(Select,{options:allCustomers,value:currentCustomer,onChange:setCurrentCustomer})]}),/*#__PURE__*/_jsx(\"div\",{class:\"form-group col-md-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"font-weight-bold my-4 py-2 px-4 btn btn-success\",onClick:function onClick(){return handleSubmit();},children:\"Submit\"})})]})}),/*#__PURE__*/_jsx(\"div\",{class:\"col-md-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return exportPDF();},class:\"font-weight-bold my-4 px-3 py-2 btn btn-success\",children:\"Export as PDF\"})})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"export-table\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-center font-weight-bold\",children:currentCustomer===null||currentCustomer===void 0?void 0:currentCustomer.label}),/*#__PURE__*/_jsxs(\"table\",{class:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Item\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Width\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Height\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Sq.Ft\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Total\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:customerDetailList.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:++index}),/*#__PURE__*/_jsx(\"td\",{children:formatDate(item.sale_date.split(' ')[0])}),/*#__PURE__*/_jsx(\"td\",{children:item.sale_items.map(function(item1){return/*#__PURE__*/_jsxs(\"p\",{children:[item1.item_name,\" (\",item1.material_name,\")\"]});})}),/*#__PURE__*/_jsx(\"td\",{children:item.sale_items.map(function(item1){return/*#__PURE__*/_jsx(\"p\",{children:item1.width});})}),/*#__PURE__*/_jsx(\"td\",{children:item.sale_items.map(function(item1){return/*#__PURE__*/_jsx(\"p\",{children:item1.height});})}),/*#__PURE__*/_jsx(\"td\",{children:item.sale_items.map(function(item1){return/*#__PURE__*/_jsx(\"p\",{children:item1.sqFt});})}),/*#__PURE__*/_jsx(\"td\",{children:item.sale_items.map(function(item1){return/*#__PURE__*/_jsx(\"p\",{children:item1.sale_price});})}),/*#__PURE__*/_jsx(\"td\",{children:item.sale_items.map(function(item1){return/*#__PURE__*/_jsx(\"p\",{children:item1.qty});})}),/*#__PURE__*/_jsx(\"td\",{children:item.sale_items.map(function(item1){return/*#__PURE__*/_jsx(\"p\",{children:parseFloat(item1.total).toFixed(2)});})})]});})})]}),paymentlist.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-center font-weight-bold\",children:\"Payment Recieved\"}),/*#__PURE__*/_jsxs(\"table\",{class:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Reciept Number\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Amount\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:paymentlist.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:++index1}),/*#__PURE__*/_jsx(\"td\",{children:item.id}),/*#__PURE__*/_jsx(\"td\",{children:formatDate(item.date.split(' ')[0])}),/*#__PURE__*/_jsx(\"td\",{children:item.amount})]});})})]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"h6\",{className:\"float-right mr-3\",children:[\"Total Amount :- \",parseFloat(totalAmount).toFixed(2)]}),/*#__PURE__*/_jsxs(\"h6\",{className:\"float-right mr-3\",children:[\"Due Amount :- \",parseFloat(dueAmount).toFixed(2)]})]})]});}","map":{"version":3,"sources":["/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/src/screens/Reports/DetailCustomerReport.js"],"names":["React","Select","url","toast","ToastContainer","userContext","formatDate","DetailCustomerReport","useContext","user","setLoad","useState","customerDetailList","setCustomerDetailList","Date","from_Date","setFromDate","to_Date","setToDate","currentCustomer","setCurrentCustomer","totalAmount","settotalAmount","dueAmount","setDueAmount","paymentlist","setPaymentList","allCustomers","setAllCustomers","index","index1","useEffect","fetchCustomers","fetch","method","headers","token","response","ok","json","data","status","client_list","map","item","value","id","label","name","normal","star","vinyl","one_way","backlit","premium","card12_18","card_12_18","sticker12_18","sticker_12_18","due_amount","error","message","handleSubmit","submit","body","formData","parseFloat","total_amount","toFixed","customer_detail","console","log","payment_list","FormData","append","JSON","stringify","catch","err","exportPDF","html","document","getElementById","innerHTML","myWindow","window","open","write","close","onload","focus","print","e","target","sale_date","split","sale_items","item1","item_name","material_name","width","height","sqFt","sale_price","qty","total","length","date","amount"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Select from 'react-select';\nimport { url } from 'src/helpers/helpers';\nimport { toast, ToastContainer } from 'react-toastify';\nimport { userContext } from '../../context/UserContext';\nimport { formatDate } from '../../helpers/helpers';\nexport default function DetailCustomerReport() {\n\n    const { user, setLoad } = React.useContext(userContext);\n    const [customerDetailList, setCustomerDetailList] = React.useState([]);\n    const [from_Date, setFromDate] = React.useState(new Date());\n    const [to_Date, setToDate] = React.useState(new Date());\n    const [currentCustomer, setCurrentCustomer] = React.useState('');\n    const [totalAmount, settotalAmount] = React.useState(0);\n    const [dueAmount, setDueAmount] = React.useState(0);\n    const [paymentlist, setPaymentList] = React.useState([]);\n    const [allCustomers, setAllCustomers] = React.useState([]);\n    let index = 0;\n    let index1 = 0;\n    React.useEffect(() => {\n        setLoad(true)\n        async function fetchCustomers() {\n            const response = await fetch(url + 'clientlist', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    setAllCustomers(data?.client_list.map(item => {\n                        return {\n                            value: item.id,\n                            label: item.name,\n                            normal: item.normal,\n                            star: item.star,\n                            vinyl: item.vinyl,\n                            one_way: item.one_way,\n                            backlit: item.backlit,\n                            premium: item.premium,\n                            card12_18: item.card_12_18,\n                            sticker12_18: item.sticker_12_18,\n                            due_amount: item.due_amount\n                        }\n                    }))\n                }\n                else {\n                    toast.error(data.message)\n                }\n            }\n        }\n        fetchCustomers();\n    }, [])\n\n    function handleSubmit() {\n        if (to_Date && from_Date && currentCustomer) {\n            setLoad(true)\n            const formData = new FormData();\n            formData.append('to', to_Date);\n            formData.append('from', from_Date);\n            formData.append('customer', JSON.stringify(currentCustomer));\n            async function submit() {\n                const response = await fetch(url + 'detailCustomerReport', {\n                    method: 'POST',\n                    headers: {\n                        'Authorization': user?.token\n                    },\n                    body: formData\n                });\n\n                if (response.ok === true) {\n                    const data = await response.json();\n                    setLoad(false)\n                    if (data.status === 200) {\n                        settotalAmount(parseFloat(data.total_amount).toFixed(2));\n                        setCustomerDetailList(data.customer_detail);\n                        setDueAmount(data.due_amount);\n                        console.log(data.payment_list);\n                        setPaymentList(data.payment_list);\n                    } else {\n                        toast.error(data.message)\n                    }\n                } else {\n                    toast.error('Oops something went wrong!')\n                }\n            }\n\n            submit().catch(err => toast.error('Internal server error!. Please try again later'))\n        } else {\n            toast.error('Please fill the to and from date')\n        }\n    }\n\n    function exportPDF() {\n        const html = document.getElementById('export-table').innerHTML;\n        var myWindow = window.open('', 'Receipt');\n        myWindow.document.write('<html><head><title>Receipt</title>');\n        myWindow.document.write('<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css\" integrity=\"sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn\" crossorigin=\"anonymous\">')\n        myWindow.document.write(\"</head><body>\");\n        myWindow.document.write(html);\n        myWindow.document.write('</body></html>');\n        myWindow.document.close();\n\n        myWindow.onload = function () {\n            myWindow.focus();\n            myWindow.print();\n        }\n    }\n\n    return (\n        <section>\n            <ToastContainer />\n            <div class=\"d-flex\">\n                <form class=\"col-md-10 m-0 p-0\">\n                    <div class=\"form-row m-0 p-0 create-purchase-header\">\n                        <div class=\"form-group col-md-3\">\n                            <label for=\"date\">From<span className='required-label'>*</span></label>\n                            <input value={from_Date} onChange={e => setFromDate(e.target.value)} type=\"date\" class=\"form-control\" id=\"date\" required />\n                        </div>\n                        <div class=\"form-group col-md-3\">\n                            <label for=\"date\">To<span className='required-label'>*</span></label>\n                            <input value={to_Date} onChange={e => setToDate(e.target.value)} type=\"date\" class=\"form-control\" id=\"date\" required />\n                        </div>\n                        <div class=\"form-group col-md-3\">\n                            <label for=\"input-customer\">Customer<span className='required-label'>*</span></label>\n                            <Select options={allCustomers} value={currentCustomer} onChange={setCurrentCustomer} />\n                        </div>\n                        <div class=\"form-group col-md-2\">\n                            <button type=\"button\" class=\"font-weight-bold my-4 py-2 px-4 btn btn-success\" onClick={() => handleSubmit()}>Submit</button>\n                        </div>\n                    </div>\n                </form>\n                <div class=\"col-md-2\">\n                    <button onClick={() => exportPDF()} class=\"font-weight-bold my-4 px-3 py-2 btn btn-success\">Export as PDF</button>\n                </div>\n            </div>\n            {/* table code */}\n            <div id=\"export-table\">\n                <h6 className='text-center font-weight-bold'>{currentCustomer?.label}</h6>\n                <table class=\"table\">\n                    <thead>\n                        <tr>\n                            <th scope=\"col\">#</th>\n                            <th scope=\"col\">Date</th>\n                            <th scope=\"col\">Item</th>\n                            <th scope=\"col\">Width</th>\n                            <th scope=\"col\">Height</th>\n                            <th scope=\"col\">Sq.Ft</th>\n                            <th scope=\"col\">Price</th>\n                            <th scope=\"col\">Qty</th>\n                            <th scope=\"col\">Total</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {customerDetailList.map((item) => {\n                            return (\n                                <tr>\n                                    <th scope=\"row\">{++index}</th>\n                                    <td>{formatDate(item.sale_date.split(' ')[0])}</td>\n                                    <td>\n                                        {item.sale_items.map((item1) => {\n                                            return (\n                                                <p>{item1.item_name} ({item1.material_name})</p>\n                                            )\n                                        })}\n                                    </td>\n                                    <td>\n                                        {item.sale_items.map((item1) => {\n                                            return (\n                                                <p>{item1.width}</p>\n                                            )\n                                        })}\n                                    </td>\n                                    <td>\n                                        {item.sale_items.map((item1) => {\n                                            return (\n                                                <p>{item1.height}</p>\n                                            )\n                                        })}\n                                    </td>\n                                    <td>\n                                        {item.sale_items.map((item1) => {\n                                            return (\n                                                <p>{item1.sqFt}</p>\n                                            )\n                                        })}\n                                    </td>\n                                    <td>\n                                        {item.sale_items.map((item1) => {\n                                            return (\n                                                <p>{item1.sale_price}</p>\n                                            )\n                                        })}\n                                    </td>\n                                    <td>\n                                        {item.sale_items.map((item1) => {\n                                            return (\n                                                <p>{item1.qty}</p>\n                                            )\n                                        })}\n                                    </td>\n                                    <td>\n                                        {item.sale_items.map((item1) => {\n                                            return (\n                                                <p>{parseFloat(item1.total).toFixed(2)}</p>\n                                            )\n                                        })}\n                                    </td>\n                                </tr>\n                            )\n                        }\n                        )}\n                    </tbody>\n                </table>\n                {paymentlist.length > 0 && (\n                    <>\n                        <h6 className='text-center font-weight-bold'>Payment Recieved</h6>\n                        <table class=\"table\">\n                            <thead>\n                                <tr>\n                                    <th scope=\"col\">#</th>\n                                    <th scope=\"col\">Reciept Number</th>\n                                    <th scope=\"col\">Date</th>\n                                    <th scope=\"col\">Amount</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {paymentlist.map((item) => {\n                                    return (\n                                        <tr>\n                                            <th scope=\"row\">{++index1}</th>\n                                            <td>{item.id}</td>\n                                            <td>{formatDate(item.date.split(' ')[0])}</td>\n                                            <td>{item.amount}</td>\n                                        </tr>\n                                    )\n                                }\n                                )}\n                            </tbody>\n                        </table>\n                    </>\n                )}\n                <hr />\n                <h6 className='float-right mr-3'>Total Amount :- {parseFloat(totalAmount).toFixed(2)}</h6>\n                <h6 className='float-right mr-3'>Due Amount :- {parseFloat(dueAmount).toFixed(2)}</h6>\n            </div>\n        </section >\n    )\n}"]},"metadata":{},"sourceType":"module"}