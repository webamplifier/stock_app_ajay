{"ast":null,"code":"import _asyncToGenerator from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{Fragment}from'react';import ReactDatatable from'@ashvin27/react-datatable';import{Link}from'react-router-dom';import{url}from'src/helpers/helpers';import{toast,ToastContainer}from'react-toastify';import{userContext}from'../../context/UserContext';import CustomModal from'../../components/CustomModal';import{formatDate}from'src/helpers/helpers';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ExpenseReport(){var _React$useContext=React.useContext(userContext),user=_React$useContext.user,setLoad=_React$useContext.setLoad;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),expenseList=_React$useState2[0],setExpenseList=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),modal=_React$useState4[0],setModal=_React$useState4[1];var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),from_Date=_React$useState6[0],setFromDate=_React$useState6[1];var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),to_Date=_React$useState8[0],setToDate=_React$useState8[1];var _React$useState9=React.useState(''),_React$useState10=_slicedToArray(_React$useState9,2),id=_React$useState10[0],setId=_React$useState10[1];var _React$useState11=React.useState(0),_React$useState12=_slicedToArray(_React$useState11,2),total=_React$useState12[0],setTotal=_React$useState12[1];var deleteEntry=function deleteEntry(){setLoad(true);function deleteData(){return _deleteData.apply(this,arguments);}function _deleteData(){_deleteData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,data,_fetchData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(url+'deleteexpense/'+id,{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:data=_context2.sent;if(data.status===200){_fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(url+'fetchExpenseList',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context.sent;if(!(response.ok===true)){_context.next=9;break;}_context.next=6;return response.json();case 6:_data=_context.sent;setLoad(false);if(_data.status===200){setExpenseList(_data.list.map(function(item,index){return{'#':index+1,'id':item.id,'expense_date':formatDate(item.expense_date.split(' ')[0]),'name':item.name,'condition':item.condition,'item_name':item.item_name,'payment_method':item.payment_method,'paid_amount':item.paid_amount};}));setTotal(parseInt(_data.total_records));}else{toast.error(_data.message);}case 9:case\"end\":return _context.stop();}}},_callee);}));return function _fetchData(){return _ref.apply(this,arguments);};}();setModal(false);setId('');_fetchData();}else{toast.error(data.message);}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return _deleteData.apply(this,arguments);}deleteData();};React.useEffect(function(){setLoad(true);function fetchData(){return _fetchData2.apply(this,arguments);}function _fetchData2(){_fetchData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(url+'fetchExpenseList',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context3.sent;if(!(response.ok===true)){_context3.next=9;break;}_context3.next=6;return response.json();case 6:data=_context3.sent;setLoad(false);if(data.status===200){setExpenseList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'expense_date':formatDate(item.expense_date.split(' ')[0]),'condition':item.condition,'name':item.name,'item_name':item.item_name,'payment_method':item.payment_method,'paid_amount':item.paid_amount};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}case 9:case\"end\":return _context3.stop();}}},_callee3);}));return _fetchData2.apply(this,arguments);}fetchData();},[]);var columns=[{key:\"#\",text:\"#\",className:\"#\",sortable:false},{key:\"expense_date\",text:\"Expense Date\",className:\"expense_date\",sortable:true},{key:\"condition\",text:\"Condition\",className:\"condition\",sortable:true},{key:\"name\",text:\"To\",className:\"name\",sortable:true},{key:\"item_name\",text:\"Item\",className:\"item_name\",sortable:true},{key:\"payment_method\",text:\"Payment Method\",className:\"payment_method\",sortable:true},{key:\"paid_amount\",text:\"Paid Amount\",className:\"paid_amount\",sortable:true},{key:\"action\",text:\"Action\",className:\"action\",width:100,sortable:false,cell:function cell(record){return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(Link,{to:\"/edit/expense/\".concat(record.id),style:{marginRight:'5px'},children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-pencil mr-2\"})}),/*#__PURE__*/_jsx(\"i\",{style:{cursor:\"pointer\"},onClick:function onClick(){return showModal(record.id);},class:\"fa fa-trash\",\"aria-hidden\":\"true\"})]});}}];var config={page_size:10,length_menu:[10,20,50],button:{excel:false,print:false,extra:false}};var showModal=function showModal(value){setId(value);setModal(true);};function fetchData(_x){return _fetchData3.apply(this,arguments);}function _fetchData3(){_fetchData3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(query){var response,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setLoad(true);_context5.next=3;return fetch(url+query,{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context5.sent;if(!(response.ok===true)){_context5.next=10;break;}_context5.next=7;return response.json();case 7:data=_context5.sent;setLoad(false);if(data.status===200){setExpenseList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'expense_date':formatDate(item.expense_date.split(' ')[0]),'name':item.name,'condition':item.condition,'item_name':item.item_name,'payment_method':item.payment_method,'paid_amount':item.paid_amount};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}case 10:case\"end\":return _context5.stop();}}},_callee5);}));return _fetchData3.apply(this,arguments);}function handleSubmit(e){e.preventDefault();if(to_Date&&from_Date){var submit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(url+\"fetchExpenseList?to=\".concat(to_Date,\"&from=\").concat(from_Date),{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context4.sent;if(!(response.ok===true)){_context4.next=11;break;}_context4.next=6;return response.json();case 6:data=_context4.sent;setLoad(false);if(data.status===200){setExpenseList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'expense_date':formatDate(item.expense_date.split(' ')[0]),'name':item.name,'condition':item.condition,'item_name':item.item_name,'payment_method':item.payment_method,'paid_amount':item.paid_amount};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}_context4.next=12;break;case 11:toast.error('Oops something went wrong!');case 12:case\"end\":return _context4.stop();}}},_callee4);}));return function submit(){return _ref2.apply(this,arguments);};}();setLoad(true);submit().catch(function(err){return toast.error('Internal server error!. Please try again later');});}else{toast.error('Please fill the to and from date');}}var handleChange=function handleChange(e){var query=\"fetchExpenseList?page_number=\".concat(e.page_number,\"&page_size=\").concat(e.page_size,\"&filter_value=\").concat(e.filter_value,\"&to=\").concat(to_Date,\"&from=\").concat(from_Date);if(e.sort_order){var sort=JSON.stringify(e.sort_order);query=\"fetchExpenseList?page_number=\".concat(e.page_number,\"&page_size=\").concat(e.page_size,\"&filter_value=\").concat(e.filter_value,\"&sort_order=\").concat(sort,\"&to=\").concat(to_Date,\"&from=\").concat(from_Date);}fetchData(query);};return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsx(CustomModal,{modal:modal,setModal:setModal,deleteEntry:deleteEntry}),/*#__PURE__*/_jsx(\"form\",{onSubmit:function onSubmit(e){return handleSubmit(e);},children:/*#__PURE__*/_jsxs(\"div\",{class:\"form-row create-purchase-header\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"date\",children:\"From\"}),/*#__PURE__*/_jsx(\"input\",{value:from_Date,onChange:function onChange(e){return setFromDate(e.target.value);},type:\"date\",class:\"form-control\",id:\"date\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"date\",children:\"To\"}),/*#__PURE__*/_jsx(\"input\",{value:to_Date,onChange:function onChange(e){return setToDate(e.target.value);},type:\"date\",class:\"form-control\",id:\"date\",required:true})]}),/*#__PURE__*/_jsx(\"div\",{class:\"form-group col-md-3\",children:/*#__PURE__*/_jsx(\"button\",{type:\"Submit\",class:\"font-weight-bold my-4 py-2 px-4 btn btn-success\",children:\"Filter\"})})]})}),/*#__PURE__*/_jsx(ReactDatatable,{config:config,records:expenseList,columns:columns,total_record:total,onChange:function onChange(e){return handleChange(e);},dynamic:true})]});}","map":{"version":3,"sources":["/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/src/screens/Reports/ExpenseReport.js"],"names":["React","Fragment","ReactDatatable","Link","url","toast","ToastContainer","userContext","CustomModal","formatDate","ExpenseReport","useContext","user","setLoad","useState","expenseList","setExpenseList","modal","setModal","from_Date","setFromDate","to_Date","setToDate","id","setId","total","setTotal","deleteEntry","deleteData","fetch","method","headers","token","response","json","data","status","fetchData","ok","list","map","item","index","expense_date","split","name","condition","item_name","payment_method","paid_amount","parseInt","total_records","error","message","useEffect","columns","key","text","className","sortable","width","cell","record","marginRight","cursor","showModal","config","page_size","length_menu","button","excel","print","extra","value","query","handleSubmit","e","preventDefault","submit","catch","err","handleChange","page_number","filter_value","sort_order","sort","JSON","stringify","target"],"mappings":"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","sourcesContent":["import React, { Fragment } from 'react';\nimport ReactDatatable from '@ashvin27/react-datatable';\nimport { Link } from 'react-router-dom';\nimport { url } from 'src/helpers/helpers';\nimport { toast, ToastContainer } from 'react-toastify'\nimport { userContext } from '../../context/UserContext'\nimport CustomModal from '../../components/CustomModal';\nimport { formatDate } from 'src/helpers/helpers';\n\nexport default function ExpenseReport() {\n    const { user, setLoad } = React.useContext(userContext);\n    const [expenseList, setExpenseList] = React.useState([]);\n    const [modal, setModal] = React.useState(false);\n    const [from_Date, setFromDate] = React.useState('');\n    const [to_Date, setToDate] = React.useState('');\n    const [id, setId] = React.useState('');\n    const [total, setTotal] = React.useState(0);\n    const deleteEntry = () => {\n        setLoad(true)\n        async function deleteData() {\n            const response = await fetch(url + 'deleteexpense/' + id, {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n\n            const data = await response.json();\n            if (data.status === 200) {\n                setModal(false);\n                setId('');\n                async function fetchData() {\n                    const response = await fetch(url + 'fetchExpenseList', {\n                        method: 'GET',\n                        headers: {\n                            'Authorization': user?.token\n                        }\n                    })\n                    if (response.ok === true) {\n                        const data = await response.json();\n                        setLoad(false)\n                        if (data.status === 200) {\n                            setExpenseList(data.list.map((item, index) => {\n                                return {\n                                    '#': index + 1,\n                                    'id': item.id,\n                                    'expense_date': formatDate(item.expense_date.split(' ')[0]),\n                                    'name': item.name,\n                                    'condition': item.condition,\n                                    'item_name': item.item_name,\n                                    'payment_method': item.payment_method,\n                                    'paid_amount': item.paid_amount\n                                }\n                            }));\n                            setTotal(parseInt(data.total_records));\n                        } else {\n                            toast.error(data.message);\n                        }\n                    }\n                }\n                fetchData();\n            } else {\n                toast.error(data.message)\n            }\n        }\n        deleteData();\n    }\n    React.useEffect(() => {\n        setLoad(true)\n        async function fetchData() {\n            const response = await fetch(url + 'fetchExpenseList', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    setExpenseList(data.list.map((item, index) => {\n                        return {\n                            '#': index + 1,\n                            'id': item.id,\n                            'expense_date': formatDate(item.expense_date.split(' ')[0]),\n                            'condition': item.condition,\n                            'name': item.name,\n                            'item_name': item.item_name,\n                            'payment_method': item.payment_method,\n                            'paid_amount': item.paid_amount\n                        }\n                    }));\n                    setTotal(parseInt(data.total_records));\n                } else {\n                    toast.error(data.message);\n                }\n            }\n        }\n\n        fetchData();\n    }, [])\n\n    const columns = [\n        {\n            key: \"#\",\n            text: \"#\",\n            className: \"#\",\n            sortable: false,\n        },\n        {\n            key: \"expense_date\",\n            text: \"Expense Date\",\n            className: \"expense_date\",\n            sortable: true\n        },\n        {\n            key: \"condition\",\n            text: \"Condition\",\n            className: \"condition\",\n            sortable: true\n        },\n        {\n            key: \"name\",\n            text: \"To\",\n            className: \"name\",\n            sortable: true\n        },\n        {\n            key: \"item_name\",\n            text: \"Item\",\n            className: \"item_name\",\n            sortable: true\n        },\n        {\n            key: \"payment_method\",\n            text: \"Payment Method\",\n            className: \"payment_method\",\n            sortable: true\n        },\n        {\n            key: \"paid_amount\",\n            text: \"Paid Amount\",\n            className: \"paid_amount\",\n            sortable: true\n        },\n        {\n            key: \"action\",\n            text: \"Action\",\n            className: \"action\",\n            width: 100,\n            sortable: false,\n            cell: record => {\n                return (\n                    <Fragment>\n                        <Link\n                            to={`/edit/expense/${record.id}`}\n                            style={{ marginRight: '5px' }}>\n                            <i className=\"fa fa-pencil mr-2\"></i>\n                        </Link>\n                        <i\n                            style={{ cursor: \"pointer\" }}\n                            onClick={() => showModal(record.id)}\n                            class=\"fa fa-trash\"\n                            aria-hidden=\"true\">\n                        </i>\n                    </Fragment>\n                );\n            }\n        }\n    ];\n    const config = {\n        page_size: 10,\n        length_menu: [10, 20, 50],\n        button: {\n            excel: false,\n            print: false,\n            extra: false,\n        }\n    }\n\n    const showModal = value => {\n        setId(value);\n        setModal(true)\n    }\n\n    async function fetchData(query) {\n        setLoad(true);\n        const response = await fetch(url + query, {\n            method: 'GET',\n            headers: {\n                'Authorization': user?.token\n            }\n        })\n        if (response.ok === true) {\n            const data = await response.json();\n            setLoad(false)\n            if (data.status === 200) {\n                setExpenseList(data.list.map((item, index) => {\n                    return {\n                        '#': index + 1,\n                        'id': item.id,\n                        'expense_date': formatDate(item.expense_date.split(' ')[0]),\n                        'name': item.name,\n                        'condition': item.condition,\n                        'item_name': item.item_name,\n                        'payment_method': item.payment_method,\n                        'paid_amount': item.paid_amount\n                    }\n                }));\n                setTotal(parseInt(data.total_records));\n            } else {\n                toast.error(data.message);\n            }\n        }\n    }\n\n    function handleSubmit(e){\n        e.preventDefault();\n        if (to_Date && from_Date){\n            setLoad(true)\n            async function submit() {\n                const response = await fetch(url + `fetchExpenseList?to=${to_Date}&from=${from_Date}`, {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': user?.token\n                    },\n                });\n                if (response.ok === true) {\n                    const data = await response.json();\n                    setLoad(false)\n                    if (data.status === 200) {\n                        setExpenseList(data.list.map((item, index) => {\n                            return {\n                                '#': index + 1,\n                                'id': item.id,\n                                'expense_date': formatDate(item.expense_date.split(' ')[0]),\n                                'name': item.name,\n                                'condition': item.condition,\n                                'item_name': item.item_name,\n                                'payment_method': item.payment_method,\n                                'paid_amount': item.paid_amount\n                            }\n                        }));\n                        setTotal(parseInt(data.total_records));\n                    } else {\n                        toast.error(data.message)\n                    }\n                } else {\n                    toast.error('Oops something went wrong!')\n                }\n            }\n            submit().catch(err => toast.error('Internal server error!. Please try again later'))\n        } else {\n            toast.error('Please fill the to and from date')\n        }\n    }\n    const handleChange = (e) => {\n        let query = `fetchExpenseList?page_number=${e.page_number}&page_size=${e.page_size}&filter_value=${e.filter_value}&to=${to_Date}&from=${from_Date}`;\n        if (e.sort_order) {\n            let sort = JSON.stringify(e.sort_order);\n            query = `fetchExpenseList?page_number=${e.page_number}&page_size=${e.page_size}&filter_value=${e.filter_value}&sort_order=${sort}&to=${to_Date}&from=${from_Date}`;\n        }\n        fetchData(query);\n    }\n    return (\n        <section>\n            <ToastContainer />\n            <CustomModal modal={modal} setModal={setModal} deleteEntry={deleteEntry} />\n            <form onSubmit={e=>handleSubmit(e)}>\n            <div class=\"form-row create-purchase-header\">\n            <div class=\"form-group col-md-3\">\n            <label for=\"date\">From</label>\n            <input value={from_Date} onChange={e => setFromDate(e.target.value)} type=\"date\" class=\"form-control\" id=\"date\" required />\n            </div>\n            <div class=\"form-group col-md-3\">\n            <label for=\"date\">To</label>\n            <input value={to_Date} onChange={e => setToDate(e.target.value)} type=\"date\" class=\"form-control\" id=\"date\" required />\n            </div>\n            <div class=\"form-group col-md-3\">\n            <button type=\"Submit\" class=\"font-weight-bold my-4 py-2 px-4 btn btn-success\">Filter</button>\n            </div>\n            </div>\n            </form>\n            <ReactDatatable\n                config={config}\n                records={expenseList}\n                columns={columns}\n                total_record={total}\n                onChange={(e) => handleChange(e)}\n                dynamic={true}\n            />\n        </section>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}