{"ast":null,"code":"import _asyncToGenerator from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{Fragment}from'react';import ReactDatatable from'@ashvin27/react-datatable';import{Link}from'react-router-dom';import{url}from'src/helpers/helpers';import{toast,ToastContainer}from'react-toastify';import{userContext}from'../../context/UserContext';import CustomModal from'../../components/CustomModal';import PayModal from'../../components/PayModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Index(){var _React$useContext=React.useContext(userContext),user=_React$useContext.user,setLoad=_React$useContext.setLoad;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),partyList=_React$useState2[0],setPartyList=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),id=_React$useState4[0],setId=_React$useState4[1];var _React$useState5=React.useState(0),_React$useState6=_slicedToArray(_React$useState5,2),payAmount=_React$useState6[0],setPayAmount=_React$useState6[1];var _React$useState7=React.useState({label:\"cash\"}),_React$useState8=_slicedToArray(_React$useState7,2),paymentMode=_React$useState8[0],setPaymentMode=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),paymodal=_React$useState10[0],setPayModal=_React$useState10[1];var _React$useState11=React.useState(false),_React$useState12=_slicedToArray(_React$useState11,2),modal=_React$useState12[0],setModal=_React$useState12[1];var _React$useState13=React.useState(0),_React$useState14=_slicedToArray(_React$useState13,2),total=_React$useState14[0],setTotal=_React$useState14[1];var payBill=function payBill(){setLoad(true);function payBillServer(){return _payBillServer.apply(this,arguments);}function _payBillServer(){_payBillServer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var formData,response,data,_fetchData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:formData=new FormData();formData.append('pay_amount',payAmount);formData.append('payment_mode',paymentMode.label);_context2.next=5;return fetch(url+'pay/party/'+id,{method:'POST',headers:{'Authorization':user.token},body:formData});case 5:response=_context2.sent;if(!response){_context2.next=11;break;}_context2.next=9;return response.json();case 9:data=_context2.sent;if(data.status===200){_fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(url+'fetchPartyList',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context.sent;if(!(response.ok===true)){_context.next=9;break;}_context.next=6;return response.json();case 6:_data=_context.sent;setLoad(false);if(_data.status===200){setPartyList(_data.list.map(function(item,index){return{'#':index+1,'id':item.id,'name':item.name,'email':item.email,'mobile':item.mobile,'gst_number':item.gst_number,'due_amount':item.due_amount};}));setTotal(parseInt(_data.total_records));}else{toast.error(_data.message);}case 9:case\"end\":return _context.stop();}}},_callee);}));return function _fetchData(){return _ref.apply(this,arguments);};}();setPayModal(false);setId('');_fetchData();}else{toast.error(data.message);}case 11:case\"end\":return _context2.stop();}}},_callee2);}));return _payBillServer.apply(this,arguments);}payBillServer();};var payModal=function payModal(item,id){setPayAmount(parseFloat(item.due_amount));setPayModal(true);setId(id);};React.useEffect(function(){setLoad(true);function fetchData(){return _fetchData2.apply(this,arguments);}function _fetchData2(){_fetchData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(url+'fetchPartyList',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context3.sent;if(!(response.ok===true)){_context3.next=8;break;}_context3.next=6;return response.json();case 6:data=_context3.sent;if(data.status===200){setLoad(false);setPartyList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'name':item.name,'email':item.email,'mobile':item.mobile,'gst_number':item.gst_number,'due_amount':item.due_amount};}));setTotal(parseInt(data.total_records));}case 8:case\"end\":return _context3.stop();}}},_callee3);}));return _fetchData2.apply(this,arguments);}fetchData();},[]);var deleteEntry=function deleteEntry(){setLoad(true);function deleteData(){return _deleteData.apply(this,arguments);}function _deleteData(){_deleteData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var response,data,_fetchData3;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return fetch(url+'deleteparty/'+id,{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context5.sent;_context5.next=5;return response.json();case 5:data=_context5.sent;if(data.status===200){_fetchData3=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response,_data2;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(url+'fetchPartyList',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context4.sent;if(!(response.ok===true)){_context4.next=8;break;}_context4.next=6;return response.json();case 6:_data2=_context4.sent;if(_data2.status===200){setLoad(false);setPartyList(_data2.list.map(function(item,index){return{'#':index+1,'id':item.id,'name':item.name,'email':item.email,'mobile':item.mobile,'gst_number':item.gst_number,'due_amount':item.due_amount};}));setTotal(parseInt(_data2.total_records));}case 8:case\"end\":return _context4.stop();}}},_callee4);}));return function _fetchData3(){return _ref2.apply(this,arguments);};}();setModal(false);setId('');_fetchData3();}else{setLoad(false);toast.error(data.message);}case 7:case\"end\":return _context5.stop();}}},_callee5);}));return _deleteData.apply(this,arguments);}deleteData();};var columns=[{key:\"#\",text:\"#\",className:\"#\",sortable:false},{key:\"name\",text:\"Party Name\",className:\"name\",sortable:true},{key:\"email\",text:\"Email\",className:\"email\",sortable:true},{key:\"mobile\",text:\"Mobile\",className:\"mobile\",sortable:true},{key:\"gst_number\",text:\"GST No.\",className:\"gst_number\",sortable:true},{key:\"due_amount\",text:\"Due Amount\",className:\"due_amount\",sortable:true},{key:\"action\",text:\"Action\",className:\"action\",width:100,sortable:false,cell:function cell(record){return/*#__PURE__*/_jsxs(Fragment,{children:[parseFloat(record.due_amount)!==0&&/*#__PURE__*/_jsx(\"i\",{style:{cursor:'pointer'},onClick:function onClick(){return payModal(record,record.id);},className:\"fa fa-money mr-2\",\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(Link,{to:\"/edit/party/\".concat(record.id),style:{marginRight:'5px'},children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-pencil mr-1\"})}),/*#__PURE__*/_jsx(\"i\",{style:{cursor:\"pointer\"},onClick:function onClick(){return showModal(record.id);},class:\"fa fa-trash\",\"aria-hidden\":\"true\"})]});}}];var config={page_size:10,length_menu:[10,20,50],button:{excel:false,print:false,extra:false}};var showModal=function showModal(value){setId(value);setModal(true);};function fetchData(_x){return _fetchData4.apply(this,arguments);}function _fetchData4(){_fetchData4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(query){var response,data;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:setLoad(true);_context6.next=3;return fetch(url+query,{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context6.sent;if(!(response.ok===true)){_context6.next=10;break;}_context6.next=7;return response.json();case 7:data=_context6.sent;setLoad(false);if(data.status===200){setPartyList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'name':item.name,'email':item.email,'mobile':item.mobile,'gst_number':item.gst_number,'due_amount':item.due_amount};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}case 10:case\"end\":return _context6.stop();}}},_callee6);}));return _fetchData4.apply(this,arguments);}var handleChange=function handleChange(e){var query=\"fetchPartyList?page_number=\".concat(e.page_number,\"&page_size=\").concat(e.page_size,\"&filter_value=\").concat(e.filter_value);if(e.sort_order){var sort=JSON.stringify(e.sort_order);query=\"fetchPartyList?page_number=\".concat(e.page_number,\"&page_size=\").concat(e.page_size,\"&filter_value=\").concat(e.filter_value,\"&sort_order=\").concat(sort);}fetchData(query);};return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsx(CustomModal,{modal:modal,setModal:setModal,deleteEntry:deleteEntry}),/*#__PURE__*/_jsx(PayModal,{paymodal:paymodal,setPayModal:setPayModal,payAmount:payAmount,setPayAmount:setPayAmount,paymentMode:paymentMode,payBill:payBill,setPaymentMode:setPaymentMode}),/*#__PURE__*/_jsx(Link,{className:\"btn btn-primary float-right\",to:\"/create/party\",children:\"Create Party\"}),/*#__PURE__*/_jsx(ReactDatatable,{config:config,records:partyList,columns:columns,total_record:total,onChange:function onChange(e){return handleChange(e);},dynamic:true})]});}","map":{"version":3,"sources":["/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/src/screens/Party/Index.js"],"names":["React","Fragment","ReactDatatable","Link","url","toast","ToastContainer","userContext","CustomModal","PayModal","Index","useContext","user","setLoad","useState","partyList","setPartyList","id","setId","payAmount","setPayAmount","label","paymentMode","setPaymentMode","paymodal","setPayModal","modal","setModal","total","setTotal","payBill","payBillServer","formData","FormData","append","fetch","method","headers","token","body","response","json","data","status","fetchData","ok","list","map","item","index","name","email","mobile","gst_number","due_amount","parseInt","total_records","error","message","payModal","parseFloat","useEffect","deleteEntry","deleteData","columns","key","text","className","sortable","width","cell","record","cursor","marginRight","showModal","config","page_size","length_menu","button","excel","print","extra","value","query","handleChange","e","page_number","filter_value","sort_order","sort","JSON","stringify"],"mappings":"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","sourcesContent":["import React,{Fragment} from 'react';\nimport ReactDatatable from '@ashvin27/react-datatable';\nimport { Link } from 'react-router-dom';\nimport { url } from 'src/helpers/helpers';\nimport { toast, ToastContainer } from 'react-toastify'\nimport { userContext } from '../../context/UserContext'\nimport CustomModal from '../../components/CustomModal';\nimport PayModal from '../../components/PayModal';\n\nexport default function Index() {\n  const { user,setLoad } = React.useContext(userContext);\n  const [partyList, setPartyList] = React.useState([]);\n  const [id, setId] = React.useState(null);\n  const [payAmount, setPayAmount] = React.useState(0);\n  const [paymentMode, setPaymentMode] = React.useState({\n    label: \"cash\"\n  });\n  const [paymodal,setPayModal] = React.useState(false);\n  const [modal, setModal] = React.useState(false);\n  const [total,setTotal] = React.useState(0);\n  \n  const payBill = () => {\n    setLoad(true)\n    async function payBillServer(){\n        const formData = new FormData();\n        formData.append('pay_amount',payAmount);\n        formData.append('payment_mode',paymentMode.label);\n        const response = await fetch(url + 'pay/party/' + id,{\n            method : 'POST',\n            headers : {\n                'Authorization' : user.token\n            },\n            body : formData\n        })\n           \n        if (response){\n            const data = await response.json();\n\n            if (data.status === 200){\n                setPayModal(false);\n                setId('');\n                async function fetchData() {\n                    const response = await fetch(url + 'fetchPartyList', {\n                        method: 'GET',\n                        headers: {\n                            'Authorization': user?.token\n                        }\n                    })\n                    if (response.ok === true) {\n                        const data = await response.json();\n                        setLoad(false)\n                        if (data.status === 200) {\n                          setPartyList(data.list.map((item, index) => {\n                            return {\n                              '#': index + 1,\n                              'id': item.id,\n                              'name': item.name,\n                              'email': item.email,\n                              'mobile': item.mobile,\n                              'gst_number': item.gst_number,\n                              'due_amount': item.due_amount\n                            }\n                          }));\n                          setTotal(parseInt(data.total_records));\n                        } else {\n                            toast.error(data.message);\n                        }\n                    }\n                }\n                fetchData();\n            }else{\n                toast.error(data.message);\n            }\n        }\n    }\n    payBillServer();\n}\n\nconst payModal = (item,id) => {\n  setPayAmount(parseFloat(item.due_amount))\n  setPayModal(true);\n  setId(id);\n}\n\n  React.useEffect(() => {\n    setLoad(true)\n    async function fetchData() {\n      const response = await fetch(url + 'fetchPartyList', {\n        method: 'GET',\n        headers: {\n          'Authorization': user?.token\n        }\n      })\n\n      if (response.ok === true) {\n        const data = await response.json();\n\n        if (data.status === 200) {\n          setLoad(false)\n          setPartyList(data.list.map((item, index) => {\n            return {\n              '#': index + 1,\n              'id': item.id,\n              'name': item.name,\n              'email': item.email,\n              'mobile': item.mobile,\n              'gst_number': item.gst_number,\n              'due_amount': item.due_amount  \n            }\n          }))\n          setTotal(parseInt(data.total_records));\n        }\n      }\n    }\n    fetchData();\n  }, [])\n\n\n  const deleteEntry = () => {\n    setLoad(true)\n    async function deleteData() {\n      const response = await fetch(url + 'deleteparty/' + id, {\n        method: 'GET',\n        headers: {\n          'Authorization': user?.token\n        }\n      })\n\n      const data = await response.json();\n\n      if (data.status === 200) {\n        setModal(false);\n        setId('');\n        async function fetchData() {\n          const response = await fetch(url + 'fetchPartyList', {\n            method: 'GET',\n            headers: {\n              'Authorization': user?.token\n            }\n          })\n    \n          if (response.ok === true) {\n            const data = await response.json();\n    \n            if (data.status === 200) {\n              setLoad(false)\n              setPartyList(data.list.map((item, index) => {\n                return {\n                  '#': index + 1,\n                  'id': item.id,\n                  'name': item.name,\n                  'email': item.email,\n                  'mobile': item.mobile,\n                  'gst_number': item.gst_number,\n                  'due_amount': item.due_amount  \n                }\n              }));\n              setTotal(parseInt(data.total_records));\n            }\n          }\n        }\n        fetchData();\n      } else {\n        setLoad(false)\n        toast.error(data.message)\n      }\n    }\n    deleteData();\n  }\n  const columns = [\n    {\n        key: \"#\",\n        text: \"#\",\n        className: \"#\",\n        sortable: false,\n    },\n    {\n        key: \"name\",\n        text: \"Party Name\",\n        className: \"name\",\n        sortable: true\n    },\n    {\n        key: \"email\",\n        text: \"Email\",\n        className: \"email\",\n        sortable: true\n    },\n    {\n        key: \"mobile\",\n        text: \"Mobile\",\n        className: \"mobile\",\n        sortable: true\n    },\n    {\n        key: \"gst_number\",\n        text: \"GST No.\",\n        className: \"gst_number\",\n        sortable: true\n    },\n    {\n      key: \"due_amount\",\n      text: \"Due Amount\",\n      className: \"due_amount\",\n      sortable: true\n    },\n    {\n        key: \"action\",\n        text: \"Action\",\n        className: \"action\",\n        width: 100,\n        sortable: false,\n        cell: record => { \n            return (\n                <Fragment>\n                    {parseFloat(record.due_amount) !== 0 && <i \n                      style={{cursor:'pointer'}} \n                      onClick={()=>payModal(record,record.id)} \n                      className=\"fa fa-money mr-2\" \n                      aria-hidden=\"true\">  \n                      </i>\n                    }\n                    <Link\n                        to={`/edit/party/${record.id}`} \n                        style={{marginRight: '5px'}}>    \n                        <i className=\"fa fa-pencil mr-1\"></i>\n                    </Link>\n                    <i \n                    style={{ cursor: \"pointer\" }} \n                    onClick={() => showModal(record.id)} \n                    class=\"fa fa-trash\" \n                    aria-hidden=\"true\">   \n                    </i>\n                </Fragment>\n            );\n        }\n    }\n];\n\nconst config = {\n    page_size: 10,\n    length_menu: [ 10, 20, 50 ],\n    button: {\n        excel: false,\n        print: false,\n        extra: false,\n    }\n} \n  const showModal = value => {\n    setId(value);\n    setModal(true)\n  }\n  \n  async function fetchData(query) {\n    setLoad(true);\n    const response = await fetch(url + query, {\n        method: 'GET',\n        headers: {\n            'Authorization': user?.token\n        }\n    })\n    if (response.ok === true) {\n        const data = await response.json();\n        setLoad(false)\n        if (data.status === 200) {\n          setPartyList(data.list.map((item, index) => {\n            return {\n              '#': index + 1,\n              'id': item.id,\n              'name': item.name,\n              'email': item.email,\n              'mobile': item.mobile,\n              'gst_number': item.gst_number,\n              'due_amount': item.due_amount\n            }\n          }));\n          setTotal(parseInt(data.total_records));\n        } else {\n            toast.error(data.message);\n        }\n    }\n}\nconst handleChange=(e)=>{\n  let query=`fetchPartyList?page_number=${e.page_number}&page_size=${e.page_size}&filter_value=${e.filter_value}`;\n  if(e.sort_order){\n      let sort = JSON.stringify(e.sort_order);\n      query=`fetchPartyList?page_number=${e.page_number}&page_size=${e.page_size}&filter_value=${e.filter_value}&sort_order=${sort}`;\n  }\n  fetchData(query);\n}\n\n  return (\n    <section>\n      <ToastContainer />\n      <CustomModal modal={modal} setModal={setModal} deleteEntry={deleteEntry} />\n      <PayModal paymodal={paymodal} setPayModal={setPayModal} payAmount={payAmount} setPayAmount={setPayAmount} paymentMode={paymentMode} payBill={payBill} setPaymentMode={setPaymentMode}  />\n      <Link className='btn btn-primary float-right' to='/create/party'>Create Party</Link>\n      <ReactDatatable\n          config={config}\n          records={partyList}\n          columns={columns}\n          total_record={total}\n          onChange={(e)=>handleChange(e)}\n          dynamic={true}\n        />\n    </section>\n  )\n}"]},"metadata":{},"sourceType":"module"}