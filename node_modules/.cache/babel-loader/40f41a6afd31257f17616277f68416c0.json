{"ast":null,"code":"import _asyncToGenerator from\"/Volumes/Disk SSD/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Volumes/Disk SSD/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Volumes/Disk SSD/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import ReactDatatable from'@ashvin27/react-datatable';import{url}from'src/helpers/helpers';import{toast,ToastContainer}from'react-toastify';import{userContext}from'../../context/UserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Index(){var _React$useContext=React.useContext(userContext),user=_React$useContext.user,setLoad=_React$useContext.setLoad;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),historyList=_React$useState2[0],setHistoryList=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),from_Date=_React$useState4[0],setFromDate=_React$useState4[1];var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),to_Date=_React$useState6[0],setToDate=_React$useState6[1];var _React$useState7=React.useState(0),_React$useState8=_slicedToArray(_React$useState7,2),total=_React$useState8[0],setTotal=_React$useState8[1];var _React$useState9=React.useState(''),_React$useState10=_slicedToArray(_React$useState9,2),purpose=_React$useState10[0],setPurpose=_React$useState10[1];var _React$useState11=React.useState(''),_React$useState12=_slicedToArray(_React$useState11,2),action=_React$useState12[0],setAction=_React$useState12[1];React.useEffect(function(){setLoad(true);function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(url+'fetchHistoryList',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context.sent;if(!(response.ok===true)){_context.next=9;break;}_context.next=6;return response.json();case 6:data=_context.sent;setLoad(false);if(data.status===200){setHistoryList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'action':item.action,'date':item.date,'purpose':item.purpose,'user_name':item.user_name};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}case 9:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();},[]);function handleSubmit(e){e.preventDefault();setLoad(true);function submit(){return _submit.apply(this,arguments);}function _submit(){_submit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(url+\"fetchHistoryList?to=\".concat(to_Date,\"&from=\").concat(from_Date,\"&purpose=\").concat(purpose,\"&action=\").concat(action),{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context2.sent;if(!(response.ok===true)){_context2.next=11;break;}_context2.next=6;return response.json();case 6:data=_context2.sent;setLoad(false);if(data.status===200){setHistoryList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'action':item.action,'date':item.date,'purpose':item.purpose,'user_name':item.user_name};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}_context2.next=12;break;case 11:toast.error('Oops something went wrong!');case 12:case\"end\":return _context2.stop();}}},_callee2);}));return _submit.apply(this,arguments);}submit();}var columns=[{key:\"#\",text:\"#\",className:\"#\",sortable:true},{key:\"action\",text:\"Action\",className:\"action\",sortable:true},{key:\"date\",text:\"Date\",className:\"date\",sortable:true},{key:\"purpose\",text:\"Purpose\",className:\"purpose\",sortable:true},{key:\"user_name\",text:\"Created By\",className:\"user_name\",sortable:true}];var config={page_size:10,length_menu:[10,20,50],button:{excel:false,print:false,extra:false}};function fetchData(_x){return _fetchData2.apply(this,arguments);}function _fetchData2(){_fetchData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(query){var response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setLoad(true);_context3.next=3;return fetch(url+query,{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context3.sent;if(!(response.ok===true)){_context3.next=10;break;}_context3.next=7;return response.json();case 7:data=_context3.sent;setLoad(false);if(data.status===200){setHistoryList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'action':item.action,'date':item.date,'purpose':item.purpose,'user_name':item.user_name};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}case 10:case\"end\":return _context3.stop();}}},_callee3);}));return _fetchData2.apply(this,arguments);}var handleChange=function handleChange(e){var string=\"\";if(to_Date&&from_Date&&action&&purpose){string=\"&to=\".concat(to_Date,\"&from=\").concat(from_Date,\"&purpose=\").concat(purpose,\"&action=\").concat(action);}else if(to_Date&&from_Date){if(purpose){string=\"&to=\".concat(to_Date,\"&from=\").concat(from_Date,\"&purpose=\").concat(purpose);}else if(action){string=\"&to=\".concat(to_Date,\"&from=\").concat(from_Date,\"&action=\").concat(action);}else{string=\"&to=\".concat(to_Date,\"&from=\").concat(from_Date);}}else if(purpose){if(action){string=\"&purpose=\".concat(purpose,\"&action=\").concat(action);}else string=\"&purpose=\".concat(purpose);}else string=\"&action=\".concat(action);var query=\"fetchHistoryList?page_number=\".concat(e.page_number,\"&page_size=\").concat(e.page_size,\"&filter_value=\").concat(e.filter_value).concat(string);if(e.sort_order){var sort=JSON.stringify(e.sort_order);query=\"fetchHistoryList?page_number=\".concat(e.page_number,\"&page_size=\").concat(e.page_size,\"&filter_value=\").concat(e.filter_value,\"&sort_order=\").concat(sort).concat(string);}fetchData(query);};return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsx(\"form\",{onSubmit:function onSubmit(e){return handleSubmit(e);},children:/*#__PURE__*/_jsxs(\"div\",{class:\"form-row create-purchase-header\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"date\",children:\"From\"}),/*#__PURE__*/_jsx(\"input\",{value:from_Date,onChange:function onChange(e){return setFromDate(e.target.value);},type:\"date\",class:\"form-control\",id:\"date\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"date\",children:\"To\"}),/*#__PURE__*/_jsx(\"input\",{value:to_Date,onChange:function onChange(e){return setToDate(e.target.value);},type:\"date\",class:\"form-control\",id:\"date\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"input-type\",class:\"col-md-4 col-form-label\",children:\"Action\"}),/*#__PURE__*/_jsxs(\"select\",{value:action,onChange:function onChange(e){return setAction(e.target.value);},id:\"input-type\",class:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Action\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Create\",children:\"Create\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Update\",children:\"Update\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Delete\",children:\"Delete\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"input-type\",class:\"col-md-4 col-form-label\",children:\"Purpose\"}),/*#__PURE__*/_jsxs(\"select\",{value:purpose,onChange:function onChange(e){return setPurpose(e.target.value);},id:\"input-type\",class:\"form-control\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Purpose\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Categories\",children:\"Category\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Customers\",children:\"Customer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Employees\",children:\"Employee\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Expenses\",children:\"Expense\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Inventories\",children:\"Inventory\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Parties\",children:\"Party\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Purchase_Start\",children:\"Purchase\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Purchase_Return\",children:\"Purchase Return\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Sale_Start\",children:\"Sales\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Sale_Return\",children:\"Sales Return\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Quotation\",children:\"Quotation\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Reciepts\",children:\"Reciept\"})]})]}),/*#__PURE__*/_jsx(\"div\",{class:\"form-group col-md-3\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",class:\"font-weight-bold my-4 py-2 px-4 btn btn-success\",children:\"Filter\"})})]})}),/*#__PURE__*/_jsx(ReactDatatable,{config:config,records:historyList,columns:columns,total_record:total,onChange:function onChange(e){return handleChange(e);},dynamic:true})]});}","map":{"version":3,"sources":["/Volumes/Disk SSD/erp2.0/erp-2.0/frontend/src/screens/Reports/HistoryReport.js"],"names":["React","ReactDatatable","url","toast","ToastContainer","userContext","Index","useContext","user","setLoad","useState","historyList","setHistoryList","from_Date","setFromDate","to_Date","setToDate","total","setTotal","purpose","setPurpose","action","setAction","useEffect","fetchData","fetch","method","headers","token","response","ok","json","data","status","list","map","item","index","id","date","user_name","parseInt","total_records","error","message","handleSubmit","e","preventDefault","submit","columns","key","text","className","sortable","config","page_size","length_menu","button","excel","print","extra","query","handleChange","string","page_number","filter_value","sort_order","sort","JSON","stringify","target","value"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDatatable from '@ashvin27/react-datatable';\nimport { url } from 'src/helpers/helpers';\nimport { toast, ToastContainer } from 'react-toastify'\nimport { userContext } from '../../context/UserContext'\n\nexport default function Index() {\n    const { user, setLoad } = React.useContext(userContext);\n    const [historyList, setHistoryList] = React.useState([]);\n    const [from_Date, setFromDate] = React.useState('');\n    const [to_Date, setToDate] = React.useState('');\n    const [total,setTotal] = React.useState(0);\n    const [purpose,setPurpose] = React.useState('');\n    const [action, setAction] = React.useState('');\n\n    React.useEffect(() => {\n        setLoad(true)\n        async function fetchData() {\n            const response = await fetch(url + 'fetchHistoryList', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    setHistoryList(data.list.map((item,index)=>{\n                        return{\n                           '#' : index+1,\n                           'id': item.id,\n                           'action': item.action,\n                           'date': item.date,\n                           'purpose': item.purpose,\n                           'user_name': item.user_name\n                        }\n                    }));\n                    setTotal(parseInt(data.total_records));\n                } else {\n                    toast.error(data.message);\n                }\n            }\n        }\n        fetchData();\n    }, [])\n\n    function handleSubmit(e){\n        e.preventDefault();\n            setLoad(true)\n            async function submit(){\n                const response = await fetch(url + `fetchHistoryList?to=${to_Date}&from=${from_Date}&purpose=${purpose}&action=${action}`,{\n                    method : 'GET',\n                    headers : {\n                        'Authorization' : user?.token\n                    }\n                });\n                 \n                if (response.ok === true){\n                    const data = await response.json();\n                    setLoad(false)\n                    if (data.status === 200){\n                        setHistoryList(data.list.map((item,index)=>{\n                            return{\n                               '#' : index+1,\n                               'id': item.id,\n                               'action': item.action,\n                               'date': item.date,\n                               'purpose': item.purpose,\n                               'user_name': item.user_name\n                            }\n                        }));\n                        setTotal(parseInt(data.total_records));\n                    }else{\n                        toast.error(data.message)\n                    }\n                }else{\n                    toast.error('Oops something went wrong!')\n                }\n            }\n            submit();\n    }\n    \n    const columns = [\n        {\n            key: \"#\",\n            text: \"#\",\n            className: \"#\",\n            sortable: true,\n        },\n        {\n            key: \"action\",\n            text: \"Action\",\n            className: \"action\",\n            sortable: true,\n        },\n        {\n            key: \"date\",\n            text: \"Date\",\n            className: \"date\",\n            sortable: true\n        },\n        {\n            key: \"purpose\",\n            text: \"Purpose\",\n            className: \"purpose\",\n            sortable: true\n        },\n        {\n            key: \"user_name\",\n            text: \"Created By\",\n            className: \"user_name\",\n            sortable: true\n        },\n    ];\n    const config = {\n        page_size: 10,\n        length_menu: [ 10, 20, 50 ],\n        button: {\n            excel: false,\n            print: false,\n            extra: false,\n        }\n    }\n    async function fetchData(query) {\n        setLoad(true);\n        const response = await fetch(url + query, {\n            method: 'GET',\n            headers: {\n                'Authorization': user?.token\n            }\n        })\n        if (response.ok === true) {\n            const data = await response.json();\n            setLoad(false)\n            if (data.status === 200) {\n                setHistoryList(data.list.map((item,index)=>{\n                    return{\n                       '#' : index+1,\n                       'id': item.id,\n                       'action': item.action,\n                       'date': item.date,\n                       'purpose': item.purpose,\n                       'user_name': item.user_name\n                    }\n                }));\n                setTotal(parseInt(data.total_records));\n            } else {\n                toast.error(data.message);\n            }\n        }\n    }\n    const handleChange=(e)=>{\n        let string=\"\";\n        if(to_Date && from_Date && action && purpose){\n           string=`&to=${to_Date}&from=${from_Date}&purpose=${purpose}&action=${action}`;\n        }\n        else if(to_Date && from_Date){\n            if(purpose){\n            string=`&to=${to_Date}&from=${from_Date}&purpose=${purpose}`;\n            }\n            else if(action){\n                string=`&to=${to_Date}&from=${from_Date}&action=${action}`;\n            }\n            else{\n                string=`&to=${to_Date}&from=${from_Date}`;\n            }\n        }\n        else if(purpose){\n            if(action){\n                string=`&purpose=${purpose}&action=${action}`;\n            }\n            else string=`&purpose=${purpose}`;\n        }\n        else string=`&action=${action}`;\n        \n        let query=`fetchHistoryList?page_number=${e.page_number}&page_size=${e.page_size}&filter_value=${e.filter_value}${string}`;\n        if(e.sort_order){\n            let sort = JSON.stringify(e.sort_order);\n            query=`fetchHistoryList?page_number=${e.page_number}&page_size=${e.page_size}&filter_value=${e.filter_value}&sort_order=${sort}${string}`;\n        }\n        fetchData(query);\n    }\n\n    return (\n        <section>\n            <ToastContainer />\n            <form onSubmit={(e)=>handleSubmit(e)}>\n            <div class=\"form-row create-purchase-header\">\n            <div class=\"form-group col-md-3\">\n            <label for=\"date\">From</label>\n            <input value={from_Date} onChange={e => setFromDate(e.target.value)} type=\"date\" class=\"form-control\" id=\"date\"/>\n            </div>\n            <div class=\"form-group col-md-3\">\n            <label for=\"date\">To</label>\n            <input value={to_Date} onChange={e => setToDate(e.target.value)} type=\"date\" class=\"form-control\" id=\"date\"/>\n            </div>\n            <div class=\"form-group col-md-3\">\n            <label for=\"input-type\" class=\"col-md-4 col-form-label\">Action</label>\n            <select value={action} onChange={e => setAction(e.target.value)} id=\"input-type\" class=\"form-control\">\n            <option value=\"\">Select Action</option>\n            <option value=\"Create\">Create</option>\n            <option value=\"Update\">Update</option>\n            <option value=\"Delete\">Delete</option>\n            </select>\n            </div>\n            <div class=\"form-group col-md-3\">\n            <label for=\"input-type\" class=\"col-md-4 col-form-label\">Purpose</label>\n            <select value={purpose} onChange={e => setPurpose(e.target.value)} id=\"input-type\" class=\"form-control\">\n            <option value=\"\">Select Purpose</option>\n            <option value=\"Categories\">Category</option>\n            <option value=\"Customers\">Customer</option>\n            <option value=\"Employees\">Employee</option>\n            <option value=\"Expenses\">Expense</option>\n            <option value=\"Inventories\">Inventory</option>\n            <option value=\"Parties\">Party</option>\n            <option value=\"Purchase_Start\">Purchase</option>\n            <option value=\"Purchase_Return\">Purchase Return</option>\n            <option value=\"Sale_Start\">Sales</option>\n            <option value=\"Sale_Return\">Sales Return</option>\n            <option value=\"Quotation\">Quotation</option>\n            <option value=\"Reciepts\">Reciept</option>\n            </select>\n            </div>\n            <div class=\"form-group col-md-3\">\n            <button type=\"submit\" class=\"font-weight-bold my-4 py-2 px-4 btn btn-success\">Filter</button>\n            </div>\n            </div>\n            </form>\n            <ReactDatatable\n                    config={config}\n                    records={historyList}\n                    columns={columns}\n                    total_record={total}\n                    onChange={(e)=>handleChange(e)}\n                    dynamic={true}\n                />\n        </section>\n    )\n}"]},"metadata":{},"sourceType":"module"}