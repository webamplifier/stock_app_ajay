{"ast":null,"code":"import _toConsumableArray from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import plus from\"../../../assets/images_manual/add.svg\";import Select from'react-select';import{url,formatDate}from'src/helpers/helpers';import{userContext}from'../../../context/UserContext';import{toast,ToastContainer}from'react-toastify';import{useHistory,useParams}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Edit(){var _useParams=useParams(),id=_useParams.id;var history=useHistory();var _React$useContext=React.useContext(userContext),user=_React$useContext.user,setLoad=_React$useContext.setLoad;var _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),invoiceNo=_React$useState2[0],setInvoiceNo=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),saleReturnDate=_React$useState4[0],setSaleReturnDate=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),default_gst=_React$useState6[0],setDefaultGST=_React$useState6[1];var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),currentCustomer=_React$useState8[0],setCurrentCustomer=_React$useState8[1];var _React$useState9=React.useState(''),_React$useState10=_slicedToArray(_React$useState9,2),currentWarehouse=_React$useState10[0],setCurrentWarehouse=_React$useState10[1];var _React$useState11=React.useState('None'),_React$useState12=_slicedToArray(_React$useState11,2),discountType=_React$useState12[0],setDiscountType=_React$useState12[1];var _React$useState13=React.useState(0),_React$useState14=_slicedToArray(_React$useState13,2),discountValue=_React$useState14[0],setDiscountValue=_React$useState14[1];var _React$useState15=React.useState({label:\"cash\"}),_React$useState16=_slicedToArray(_React$useState15,2),currentPaymentMethod=_React$useState16[0],setCurrentPaymentMethod=_React$useState16[1];var _React$useState17=React.useState('percent'),_React$useState18=_slicedToArray(_React$useState17,2),currentDiscountCriteria=_React$useState18[0],setCurrentDiscountCriteria=_React$useState18[1];var _React$useState19=React.useState(''),_React$useState20=_slicedToArray(_React$useState19,2),currentProduct=_React$useState20[0],setCurrentProduct=_React$useState20[1];var _React$useState21=React.useState(0),_React$useState22=_slicedToArray(_React$useState21,2),finalDiscountValue=_React$useState22[0],setFinalDiscountValue=_React$useState22[1];var _React$useState23=React.useState('percent'),_React$useState24=_slicedToArray(_React$useState23,2),finalDiscountCriteria=_React$useState24[0],setFinalDiscountCriteria=_React$useState24[1];var _React$useState25=React.useState(0),_React$useState26=_slicedToArray(_React$useState25,2),sale_return_price=_React$useState26[0],setSaleReturnPrice=_React$useState26[1];var _React$useState27=React.useState({value:0,label:0}),_React$useState28=_slicedToArray(_React$useState27,2),gst=_React$useState28[0],setGST=_React$useState28[1];var _React$useState29=React.useState(1),_React$useState30=_slicedToArray(_React$useState29,2),qty=_React$useState30[0],setQty=_React$useState30[1];var _React$useState31=React.useState([]),_React$useState32=_slicedToArray(_React$useState31,2),gst_list=_React$useState32[0],setGSTList=_React$useState32[1];var _React$useState33=React.useState(''),_React$useState34=_slicedToArray(_React$useState33,2),remarks=_React$useState34[0],setRemarks=_React$useState34[1];var _React$useState35=React.useState([]),_React$useState36=_slicedToArray(_React$useState35,2),allCustomers=_React$useState36[0],setAllCustomers=_React$useState36[1];var _React$useState37=React.useState([]),_React$useState38=_slicedToArray(_React$useState37,2),allPaymentMethods=_React$useState38[0],setAllPaymentMethods=_React$useState38[1];var _React$useState39=React.useState([]),_React$useState40=_slicedToArray(_React$useState39,2),allWarehouses=_React$useState40[0],setAllWarehouses=_React$useState40[1];var _React$useState41=React.useState([]),_React$useState42=_slicedToArray(_React$useState41,2),allItems=_React$useState42[0],setAllItems=_React$useState42[1];var _React$useState43=React.useState([]),_React$useState44=_slicedToArray(_React$useState43,2),allProducts=_React$useState44[0],setAllProducts=_React$useState44[1];//final related variables and states\nvar finalAmount=0;var remainAmount=0;var discount_amount_final=0;var amount_before_discount_final=0;var amount_after_discount_final=0;var _React$useState45=React.useState(0),_React$useState46=_slicedToArray(_React$useState45,2),paidAmount=_React$useState46[0],setPaidAmount=_React$useState46[1];var _React$useState47=React.useState(0),_React$useState48=_slicedToArray(_React$useState47,2),totalValue=_React$useState48[0],setTotalValue=_React$useState48[1];var _React$useState49=React.useState(0),_React$useState50=_slicedToArray(_React$useState49,2),discountAmount=_React$useState50[0],setDiscountAmount=_React$useState50[1];var _React$useState51=React.useState(0),_React$useState52=_slicedToArray(_React$useState51,2),taxAmount=_React$useState52[0],setTaxableAmount=_React$useState52[1];//edit related states\nvar _React$useState53=React.useState(''),_React$useState54=_slicedToArray(_React$useState53,2),currentEditItem=_React$useState54[0],setCurrentEditItem=_React$useState54[1];//item based variables\nvar perItemAmount=0;var tax_amount=0;var amount_item=0;var amount_before_discount=0;var amount_after_discount=0;var amount_after_tax=0;var discount_amount=0;React.useEffect(function(){function fetchPaymentMethods(){return _fetchPaymentMethods.apply(this,arguments);}function _fetchPaymentMethods(){_fetchPaymentMethods=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoad(true);_context.next=3;return fetch(url+'getPaymentMethods',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;setLoad(false);setAllPaymentMethods(data===null||data===void 0?void 0:data.payment_methods.map(function(item){return{label:item};}));case 9:case\"end\":return _context.stop();}}},_callee);}));return _fetchPaymentMethods.apply(this,arguments);}fetchPaymentMethods();function fetchDataParty(){return _fetchDataParty.apply(this,arguments);}function _fetchDataParty(){_fetchDataParty=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoad(true);_context2.next=3;return fetch(url+'clientlist',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context2.sent;if(!(response.ok===true)){_context2.next=10;break;}_context2.next=7;return response.json();case 7:data=_context2.sent;setLoad(false);if(data.status===200){console.log(data);setAllCustomers(data===null||data===void 0?void 0:data.client_list.map(function(item){return{value:item.id,label:item.name,amount:item.due_amount};}));}else{toast.error(data.message);}case 10:case\"end\":return _context2.stop();}}},_callee2);}));return _fetchDataParty.apply(this,arguments);}fetchDataParty();function fetchGSTList(){return _fetchGSTList.apply(this,arguments);}function _fetchGSTList(){_fetchGSTList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setLoad(true);_context3.next=3;return fetch(url+'getGSTList',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context3.sent;_context3.next=6;return response.json();case 6:data=_context3.sent;setLoad(false);setGSTList(data===null||data===void 0?void 0:data.gst.map(function(item){return{value:item,label:item};}));case 9:case\"end\":return _context3.stop();}}},_callee3);}));return _fetchGSTList.apply(this,arguments);}fetchGSTList();function fetchWarehouse(){return _fetchWarehouse.apply(this,arguments);}function _fetchWarehouse(){_fetchWarehouse=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setLoad(true);_context4.next=3;return fetch(url+'warehouselist',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context4.sent;if(!(response.ok===true)){_context4.next=10;break;}_context4.next=7;return response.json();case 7:data=_context4.sent;setLoad(false);if(data.status===200){setAllWarehouses(data===null||data===void 0?void 0:data.warehouse_list.map(function(item){return{value:item.id,label:item.name};}));}else{toast.error(data.message);}case 10:case\"end\":return _context4.stop();}}},_callee4);}));return _fetchWarehouse.apply(this,arguments);}fetchWarehouse();function fetchDetailSales(){return _fetchDetailSales.apply(this,arguments);}function _fetchDetailSales(){_fetchDetailSales=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var response,data,header,final_discount_criteria,final_discount_value,items,midItems,i,current_item,discount_type,discount_value,obj,current_total_fetch,_discount_amount,taxable_amount;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setLoad(true);_context5.next=3;return fetch(url+'getSaleReturnById/'+id,{headers:{'Authorization':user.token}});case 3:response=_context5.sent;if(!(response.ok===true)){_context5.next=10;break;}_context5.next=7;return response.json();case 7:data=_context5.sent;setLoad(false);if(data.status===200){header=data.sale_return_header;final_discount_criteria='';final_discount_value=0;if(parseFloat(header.bill_discount_percentage)>0){final_discount_criteria='percent';final_discount_value=header.bill_discount_percentage;}else if(parseFloat(header.bill_discount_amount)>0){final_discount_criteria='amount';final_discount_value=header.bill_discount_amount;}items=data.sale_return_items;setInvoiceNo(header.invoice_number);setSaleReturnDate(header.sale_return_date);setCurrentCustomer({value:header.customer_id,label:header.customer_name});setCurrentWarehouse({value:header.warehouse_id,label:header.warehouse_name});fetchProd(header.warehouse_id);setDiscountType(header.discount_type);midItems=[];for(i=0;i<items.length;i++){current_item=items[i];discount_type='';discount_value=0;if(current_item.discount_percent&&parseFloat(current_item.discount_percent)>0){discount_type='percent';discount_value=current_item.discount_percent;}else if(current_item.discount_amount){discount_type='amount';discount_value=current_item.discount_amount;}else{//\n}obj={};if(header.default_gst===\"true\"){setDefaultGST(true);obj={item:{value:current_item.product_id,label:current_item.product_name,type:current_item.product_type,unit:current_item.product_unit,price:current_item.sale_return_price,hsbn:current_item.product_hsbn,serial_no:current_item.product_serial_no},item_id:current_item.id,sale_return_price:current_item.sale_return_price,qty:current_item.qty,discount_type:discount_type,discountValue:discount_value,gst:{label:current_item.tax_percent,value:current_item.tax_percent},total:current_item.total,amount_item:current_item.total,amount_after_tax:current_item.amount_after_tax,amount_before_discount:current_item.amount_before_discount,tax_amount:current_item.tax_amount,discount_amount:current_item.discount_amount,amount_after_discount:current_item.amount_after_discount,warehouse_id:current_item.warehouse_id,warehouse_name:current_item.warehouse_name};}else{setDefaultGST(false);obj={item:{value:current_item.product_id,label:current_item.product_name,type:current_item.product_type,unit:current_item.product_unit,hsbn:current_item.product_hsbn,price:current_item.sale_return_price,serial_no:current_item.product_serial_no},item_id:current_item.id,sale_return_price:current_item.sale_return_price,qty:current_item.qty,discount_type:discount_type,discountValue:discount_value,gst:{value:0,label:0},total:current_item.total,amount_item:current_item.total,amount_after_tax:current_item.amount_after_tax,amount_before_discount:current_item.amount_before_discount,tax_amount:current_item.tax_amount,discount_amount:current_item.discount_amount,amount_after_discount:current_item.amount_after_discount,warehouse_id:current_item.warehouse_id,warehouse_name:current_item.warehouse_name};}midItems.push(obj);}setAllItems(midItems);current_total_fetch=0;_discount_amount=0;taxable_amount=0;midItems.map(function(item){current_total_fetch=parseFloat(current_total_fetch)+parseFloat(item.total);_discount_amount=parseFloat(_discount_amount)+parseFloat(item.discount_amount);taxable_amount=parseFloat(taxable_amount)+parseFloat(item.tax_amount);});setTotalValue(current_total_fetch);setDiscountAmount(_discount_amount);setTaxableAmount(taxable_amount);setFinalDiscountValue(final_discount_value);setFinalDiscountCriteria(final_discount_criteria);setPaidAmount(header.amount_paid);setCurrentPaymentMethod({label:\"cash\"});setRemarks(header.remarks);}else{toast.error(data.message);}case 10:case\"end\":return _context5.stop();}}},_callee5);}));return _fetchDetailSales.apply(this,arguments);}fetchDetailSales();},[]);function fetchProd(_x){return _fetchProd.apply(this,arguments);}function _fetchProd(){_fetchProd=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(e){var response,data,products;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:setLoad(true);_context7.next=3;return fetch(url+\"fetchProducts?warehouse=\".concat(e),{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context7.sent;if(!(response.ok===true)){_context7.next=10;break;}_context7.next=7;return response.json();case 7:data=_context7.sent;setLoad(false);if(data.status===200){products=[];if(data.inventory_list){data.inventory_list.map(function(item){products.push({value:item.product_id,label:item.product_name,type:\"product\",unit:item.product_unit,price:item.sale_unit_price,hsbn:item.product_hsbn,serial_no:item.product_serial_no});});}if(data.product_list){data.product_list.map(function(item){products.push({value:item.id,label:item.name,type:item.type,unit:item.unit,price:item.price,hsbn:item.hsbn,serial_no:item.serial_no});});}setAllProducts(products);}else{toast.error(data.message);}case 10:case\"end\":return _context7.stop();}}},_callee7);}));return _fetchProd.apply(this,arguments);}var calculateTotal=function calculateTotal(){if(sale_return_price>0&&qty>0){amount_item=parseFloat(sale_return_price)*parseFloat(qty);//amount before tax\ntax_amount=0;if(default_gst&&gst){tax_amount=parseFloat(amount_item)/100*parseFloat(gst.value);}amount_after_tax=amount_item+tax_amount;perItemAmount=amount_after_tax;if(discountType==='Item'||discountType==='Both'){amount_before_discount=amount_after_tax;if(currentDiscountCriteria==='percent'){discount_amount=parseFloat(amount_before_discount)/100*parseFloat(discountValue);amount_after_discount=amount_before_discount-discount_amount;perItemAmount=amount_after_discount;}if(currentDiscountCriteria==='amount'){discount_amount=parseFloat(discountValue);amount_after_discount=amount_before_discount-discount_amount;perItemAmount=amount_after_discount;}}}};calculateTotal();var calculateFinalPrice=function calculateFinalPrice(){if(totalValue>0){if(discountType==='Bill'||discountType==='Both'){if(finalDiscountCriteria==='percent'){discount_amount_final=totalValue/100*parseFloat(finalDiscountValue);amount_before_discount_final=totalValue;amount_after_discount_final=totalValue-discount_amount_final;}if(finalDiscountCriteria==='amount'){discount_amount_final=parseFloat(finalDiscountValue);amount_before_discount_final=totalValue;amount_after_discount_final=totalValue-discount_amount_final;}finalAmount=amount_after_discount_final;remainAmount=finalAmount-parseFloat(paidAmount);}else{finalAmount=totalValue;remainAmount=finalAmount-parseFloat(paidAmount);}}};calculateFinalPrice();var handleSubmitItem=function handleSubmitItem(){if(invoiceNo&&saleReturnDate&&currentProduct&&currentWarehouse&&currentCustomer&&sale_return_price&&qty){var new_item_dict={item:currentProduct,sale_return_price:sale_return_price,qty:qty,gst:gst,discount_type:currentDiscountCriteria,discountValue:discountValue,total:perItemAmount,amount_item:amount_item,amount_before_discount:amount_before_discount,discount_amount:discount_amount,tax_amount:tax_amount,amount_after_discount:amount_after_discount,warehouse_id:currentWarehouse.value,warehouse_name:currentWarehouse.label};if(currentEditItem){setCurrentEditItem('');var new_list_edit=[];allItems.map(function(item,index){if(index===parseInt(currentEditItem)-1){new_list_edit.push(new_item_dict);}else{new_list_edit.push(item);}});var total=0;var _discount_amount2=0;var taxable_amount=0;new_list_edit.map(function(item){total=parseFloat(total)+parseFloat(item.total);_discount_amount2=parseFloat(_discount_amount2)+parseFloat(item.discount_amount);taxable_amount=parseFloat(taxable_amount)+parseFloat(item.tax_amount);});setTotalValue(total);setDiscountAmount(_discount_amount2);setTaxableAmount(taxable_amount);setAllItems(new_list_edit);}else{var new_item_list=[].concat(_toConsumableArray(allItems),[new_item_dict]);var _total=0;var _taxable_amount=0;new_item_list.map(function(item){_total=parseFloat(_total)+parseFloat(item.total);discount_amount=parseFloat(discount_amount)+parseFloat(item.discount_amount);_taxable_amount=parseFloat(_taxable_amount)+parseFloat(item.tax_amount);});setDiscountAmount(discount_amount);setTaxableAmount(_taxable_amount);setTotalValue(_total);setTotalValue(parseFloat(totalValue)+parseFloat(perItemAmount));setAllItems(new_item_list);}setCurrentProduct('');setSaleReturnPrice(0);setCurrentDiscountCriteria('');setDiscountValue(0);setQty(1);setGST({label:0,value:0});perItemAmount=0;amount_item=0;amount_before_discount=0;amount_after_discount=0;discount_amount=0;tax_amount=0;amount_after_tax=0;}else{toast.error('Fill all fields having *');}};var finalSubmit=function finalSubmit(){if(invoiceNo&&saleReturnDate&&currentWarehouse&&currentCustomer&&allItems.length>0&&totalValue){var submitSales=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var response,data;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return fetch(url+'updateSaleReturn/'+id,{method:'POST',headers:{'Authorization':user.token},body:formData});case 2:response=_context6.sent;if(!(response.ok===true)){_context6.next=9;break;}_context6.next=6;return response.json();case 6:data=_context6.sent;setLoad(false);if(data.status===200){toast.success(data.message);history.push('/salesReturnReport');}else{toast.error(data.message);}case 9:case\"end\":return _context6.stop();}}},_callee6);}));return function submitSales(){return _ref.apply(this,arguments);};}();setLoad(true);var header={invoiceNo:invoiceNo,saleReturnDate:saleReturnDate,currentCustomer:currentCustomer,currentWarehouse:currentWarehouse,discountType:discountType,default_gst:default_gst};var final={totalValue:totalValue,finalAmount:finalAmount,paidAmount:paidAmount,remainAmount:remainAmount,finalDiscountValue:finalDiscountValue,finalDiscountCriteria:finalDiscountCriteria,remarks:remarks,paymentMethod:currentPaymentMethod.label,discountAmount:discountAmount,taxableAmount:taxAmount};var final_array=[];final_array.push(header);final_array.push(final);var formData=new FormData();formData.append('final_array',JSON.stringify(final_array));formData.append('allItems',JSON.stringify(allItems));submitSales();}else{toast.error('Please fill the data with *');}};var handleEdit=function handleEdit(item,index_value){setCurrentEditItem(index_value);setCurrentProduct(item.item);setSaleReturnPrice(item.sale_return_price);setQty(item.qty);setGST(item.gst);setCurrentDiscountCriteria(item.discount_type);setDiscountValue(item.discountValue);perItemAmount=item.total;};var handleDelete=function handleDelete(index_value){var new_item=[];allItems.map(function(item,index){if(index!==index_value){new_item.push(item);}});var total=0;var discount_amount=0;var taxable_amount=0;new_item.map(function(item){total=parseFloat(total)+parseFloat(item.total);discount_amount=parseFloat(discount_amount)+parseFloat(item.discount_amount);taxable_amount=parseFloat(taxable_amount)+parseFloat(item.tax_amount);});setDiscountAmount(discount_amount);setTaxableAmount(taxable_amount);setTotalValue(total);setAllItems(new_item);};var handleProduct=function handleProduct(e){setCurrentProduct(e);setSaleReturnPrice(e.price);};return/*#__PURE__*/_jsxs(\"div\",{className:\"container full-size-create-page-main-section\",children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-sm-5 px-md-3 create-form-field create-purchase-page\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"py-4 px-2 form-row create-purchase-header\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"invoice-number\",children:[\"Invoice No.\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{readOnly:true,value:invoiceNo,type:\"text\",class:\"form-control\",id:\"invoice-number\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-4\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"input-party\",children:[\"Warehouse\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(Select,{readOnly:true,options:allWarehouses,value:currentWarehouse})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-4\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"date\",children:\"Sale Return Date\"}),/*#__PURE__*/_jsx(\"input\",{value:saleReturnDate,onChange:function onChange(e){return setSaleReturnDate(e.target.value);},type:\"date\",class:\"form-control\",id:\"date\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-4\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"input-party\",children:[\"Customer\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(Select,{options:allCustomers,value:currentCustomer})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group my-md-3 col-md-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-2 font-weight-bold\",children:/*#__PURE__*/_jsxs(\"label\",{for:\"input-party\",children:[\"Discount Type\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"row px-3\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-check col-sm-3\",children:[/*#__PURE__*/_jsx(\"input\",{checked:discountType==='None'&&true,onClick:function onClick(){return setDiscountType('None');},class:\"form-check-input\",name:\"discount\",type:\"radio\",value:\"\",id:\"defaultCheck1\"}),/*#__PURE__*/_jsx(\"label\",{class:\"form-check-label\",for:\"defaultCheck1\",children:\"None\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-check col-sm-3\",children:[/*#__PURE__*/_jsx(\"input\",{checked:discountType==='Item'&&true,onClick:function onClick(){return setDiscountType('Item');},class:\"form-check-input\",name:\"discount\",type:\"radio\",value:\"\",id:\"defaultCheck2\"}),/*#__PURE__*/_jsx(\"label\",{class:\"form-check-label\",for:\"defaultCheck2\",children:\"Item\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-check col-sm-3\",children:[/*#__PURE__*/_jsx(\"input\",{checked:discountType==='Bill'&&true,onClick:function onClick(){return setDiscountType('Bill');},class:\"form-check-input\",name:\"discount\",type:\"radio\",value:\"\",id:\"defaultCheck3\"}),/*#__PURE__*/_jsx(\"label\",{class:\"form-check-label\",for:\"defaultCheck3\",children:\"Bill\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-check col-sm-3\",children:[/*#__PURE__*/_jsx(\"input\",{checked:discountType==='Both'&&true,onClick:function onClick(){return setDiscountType('Both');},class:\"form-check-input\",name:\"discount\",type:\"radio\",value:\"\",id:\"defaultCheck3\"}),/*#__PURE__*/_jsx(\"label\",{class:\"form-check-label\",for:\"defaultCheck3\",children:\"Both\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-2\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"inputPassword\",class:\"col-sm-2 col-form-label\",children:\"GST:\"}),/*#__PURE__*/_jsx(\"div\",{class:\"d-flex b-0 col-sm-1\",children:/*#__PURE__*/_jsx(\"input\",{readOnly:true,checked:default_gst,type:\"checkbox\",id:\"inputPassword\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"my-4 form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-4\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"invoice-number\",children:[\"Item\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(Select,{options:allProducts,value:currentProduct,onChange:function onChange(e){return handleProduct(e);}})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-4\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"invoice-number\",children:[\"Price\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{value:sale_return_price,onChange:function onChange(e){return setSaleReturnPrice(e.target.value);},type:\"text\",class:\"form-control\",id:\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-4\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"invoice-number\",children:[\"Quantity\",currentProduct?\" (\".concat(currentProduct.unit,\")\"):null,/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{value:qty,onChange:function onChange(e){return setQty(e.target.value);},type:\"text\",class:\"form-control\",id:\"\"})]}),default_gst&&/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-4\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"invoice-number\",children:[\"GST:\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(Select,{options:gst_list,value:gst,onChange:setGST})]}),discountType==='Item'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group col-md-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"\",children:\"Discount\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"m-0 p-0 col-12 row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-0 col-5\",children:/*#__PURE__*/_jsx(\"input\",{value:discountValue,onChange:function onChange(e){return setDiscountValue(e.target.value);},class:\"form-control\",type:\"text\",name:\"\",id:\"\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-0 col-7\",children:/*#__PURE__*/_jsxs(\"select\",{value:currentDiscountCriteria,onChange:function onChange(e){return setCurrentDiscountCriteria(e.target.value);},class:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"percent\",children:\"Percent\"}),/*#__PURE__*/_jsx(\"option\",{value:\"amount\",children:\"Amount\"})]})})]})]}),discountType==='Both'&&/*#__PURE__*/_jsxs(\"div\",{className:\"form-group col-md-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"\",children:\"Discount\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"m-0 p-0 col-12 row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-0 col-5\",children:/*#__PURE__*/_jsx(\"input\",{value:discountValue,onChange:function onChange(e){return setDiscountValue(e.target.value);},class:\"form-control\",type:\"text\",name:\"\",id:\"\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-0 col-7\",children:/*#__PURE__*/_jsxs(\"select\",{value:currentDiscountCriteria,onChange:function onChange(e){return setCurrentDiscountCriteria(e.target.value);},class:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"percent\",children:\"Percent\"}),/*#__PURE__*/_jsx(\"option\",{value:\"amount\",children:\"Amount\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-4 row\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-9\",children:[/*#__PURE__*/_jsxs(\"label\",{for:\"invoice-number\",children:[\"Total\",/*#__PURE__*/_jsx(\"span\",{className:\"required-label\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"input\",{value:perItemAmount,readOnly:true,type:\"text\",class:\"form-control\",id:\"\"})]}),/*#__PURE__*/_jsx(\"div\",{class:\"form-group col-3 p-0 purchase-create-mid-plus-img\",children:/*#__PURE__*/_jsx(\"img\",{className:\"img-fluid\",onClick:function onClick(){return handleSubmitItem();},style:{cursor:'pointer'},src:plus,alt:\"\"})})]})]}),allItems.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"my-table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{class:\"table mt-4\",children:[/*#__PURE__*/_jsx(\"thead\",{class:\"thead-dark\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Item\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"GST\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Discount\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"table-borderless\",children:allItems.map(function(item,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"p-0 m-0\",children:item.item.label}),/*#__PURE__*/_jsxs(\"p\",{children:[\"(\",item.warehouse_name,\")\"]})]}),/*#__PURE__*/_jsx(\"td\",{children:item.sale_return_price}),/*#__PURE__*/_jsx(\"td\",{children:item.qty}),/*#__PURE__*/_jsxs(\"td\",{children:[item.gst.value,\"%\"]}),/*#__PURE__*/_jsxs(\"td\",{children:[item.discountValue,\" \",item.discount_type]}),/*#__PURE__*/_jsx(\"td\",{children:item.total}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"i\",{style:{cursor:'pointer'},onClick:function onClick(){return handleEdit(item,index+1);},class:\"fa fa-pencil\",\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(\"i\",{onClick:function onClick(){return handleDelete(index);},style:{cursor:\"pointer\"},class:\"fa fa-trash\",\"aria-hidden\":\"true\"})]})]});})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"row mt-5 justify-content-between purchase-create-footer\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-5\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"exampleFormControlTextarea1\",children:\"Remarks\"}),/*#__PURE__*/_jsx(\"textarea\",{value:remarks,onChange:function onChange(e){return setRemarks(e.target.value);},class:\"form-control\",id:\"exampleFormControlTextarea1\",rows:\"5\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group row\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"\",class:\"col-md-4 col-form-label\",children:\"Total Value\"}),/*#__PURE__*/_jsx(\"div\",{class:\"col-md-8\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:totalValue,class:\"form-control\",id:\"\"})})]}),discountType==='Bill'&&/*#__PURE__*/_jsxs(\"div\",{class:\"form-group row\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"\",class:\"col-md-4 col-form-label\",children:\"Discount\"}),/*#__PURE__*/_jsxs(\"div\",{class:\"pr-0 col-md-8 row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pr-0 col-5\",children:/*#__PURE__*/_jsx(\"input\",{class:\"form-control\",value:finalDiscountValue,onChange:function onChange(e){return setFinalDiscountValue(e.target.value);},type:\"text\",name:\"\",id:\"\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-0 col-7\",children:/*#__PURE__*/_jsxs(\"select\",{value:finalDiscountCriteria,onChange:function onChange(e){return setFinalDiscountCriteria(e.target.value);},class:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"percent\",children:\"Percent\"}),/*#__PURE__*/_jsx(\"option\",{value:\"amount\",children:\"Amount\"})]})})]})]}),discountType==='Both'&&/*#__PURE__*/_jsxs(\"div\",{class:\"form-group row\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"\",class:\"col-md-4 col-form-label\",children:\"Discount\"}),/*#__PURE__*/_jsxs(\"div\",{class:\"pr-0 col-md-8 row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pr-0 col-5\",children:/*#__PURE__*/_jsx(\"input\",{class:\"form-control\",type:\"text\",value:finalDiscountValue,onChange:function onChange(e){return setFinalDiscountValue(e.target.value);}})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-0 col-7\",children:/*#__PURE__*/_jsxs(\"select\",{value:finalDiscountCriteria,onChange:function onChange(e){return setFinalDiscountCriteria(e.target.value);},class:\"form-control\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"percent\",children:\"Percent\"}),/*#__PURE__*/_jsx(\"option\",{value:\"amount\",children:\"Amount\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group row\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"\",class:\"col-md-4 col-form-label\",children:\"Final Amount\"}),/*#__PURE__*/_jsx(\"div\",{class:\"col-md-8\",children:/*#__PURE__*/_jsx(\"input\",{readOnly:true,value:finalAmount,type:\"text\",class:\"form-control\",id:\"\"})})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group row\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"\",class:\"col-md-4 col-form-label\",children:\"Paid Amount\"}),/*#__PURE__*/_jsx(\"div\",{class:\"col-md-8\",children:/*#__PURE__*/_jsx(\"input\",{value:paidAmount,type:\"text\",class:\"form-control\",id:\"\"})})]}),paidAmount>0&&/*#__PURE__*/_jsxs(\"div\",{class:\"form-group row\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"\",class:\"col-md-4 col-form-label\",children:\"Payment Method\"}),/*#__PURE__*/_jsx(\"div\",{class:\"col-md-8\",children:/*#__PURE__*/_jsx(Select,{options:allPaymentMethods,value:currentPaymentMethod})})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group row\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"\",class:\"col-md-4 col-form-label\",children:\"Remain Amount\"}),/*#__PURE__*/_jsx(\"div\",{class:\"col-md-8\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:remainAmount,readOnly:true,class:\"form-control\",id:\"\"})})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"d-flex justify-content-center create-catagory-btns\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:function onClick(){return window.location.reload();},class:\"font-weight-bold m-3 py-2 px-4 btn btn-danger\",children:[\"Cancel\",/*#__PURE__*/_jsx(\"i\",{class:\"px-2 fa fa-times\",\"aria-hidden\":\"true\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:function onClick(){return finalSubmit();},class:\"font-weight-bold m-3 py-2 px-4 btn btn-success\",children:[\"Save\",/*#__PURE__*/_jsx(\"i\",{class:\"px-2 fa fa-floppy-o\",\"aria-hidden\":\"true\"})]})]})]})]});}","map":{"version":3,"sources":["/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/src/screens/Sales/Sales Return/edit.js"],"names":["React","Select","url","formatDate","userContext","toast","ToastContainer","useHistory","useParams","Edit","id","history","useContext","user","setLoad","useState","invoiceNo","setInvoiceNo","saleReturnDate","setSaleReturnDate","default_gst","setDefaultGST","currentCustomer","setCurrentCustomer","currentWarehouse","setCurrentWarehouse","discountType","setDiscountType","discountValue","setDiscountValue","label","currentPaymentMethod","setCurrentPaymentMethod","currentDiscountCriteria","setCurrentDiscountCriteria","currentProduct","setCurrentProduct","finalDiscountValue","setFinalDiscountValue","finalDiscountCriteria","setFinalDiscountCriteria","sale_return_price","setSaleReturnPrice","value","gst","setGST","qty","setQty","gst_list","setGSTList","remarks","setRemarks","allCustomers","setAllCustomers","allPaymentMethods","setAllPaymentMethods","allWarehouses","setAllWarehouses","allItems","setAllItems","allProducts","setAllProducts","finalAmount","remainAmount","discount_amount_final","amount_before_discount_final","amount_after_discount_final","paidAmount","setPaidAmount","totalValue","setTotalValue","discountAmount","setDiscountAmount","taxAmount","setTaxableAmount","currentEditItem","setCurrentEditItem","perItemAmount","tax_amount","amount_item","amount_before_discount","amount_after_discount","amount_after_tax","discount_amount","useEffect","fetchPaymentMethods","fetch","method","headers","token","response","json","data","payment_methods","map","item","fetchDataParty","ok","status","console","log","client_list","name","amount","due_amount","error","message","fetchGSTList","fetchWarehouse","warehouse_list","fetchDetailSales","header","sale_return_header","final_discount_criteria","final_discount_value","parseFloat","bill_discount_percentage","bill_discount_amount","items","sale_return_items","invoice_number","sale_return_date","customer_id","customer_name","warehouse_id","warehouse_name","fetchProd","discount_type","midItems","i","length","current_item","discount_value","discount_percent","obj","product_id","product_name","type","product_type","unit","product_unit","price","hsbn","product_hsbn","serial_no","product_serial_no","item_id","tax_percent","total","push","current_total_fetch","taxable_amount","amount_paid","e","products","inventory_list","sale_unit_price","product_list","calculateTotal","calculateFinalPrice","handleSubmitItem","new_item_dict","new_list_edit","index","parseInt","new_item_list","finalSubmit","submitSales","body","formData","success","final","paymentMethod","taxableAmount","final_array","FormData","append","JSON","stringify","handleEdit","index_value","handleDelete","new_item","handleProduct","target","cursor","plus","window","location","reload"],"mappings":"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","sourcesContent":["import React from 'react'\nimport plus from '../../../assets/images_manual/add.svg'\nimport Select from 'react-select';\nimport { url, formatDate } from 'src/helpers/helpers';\nimport { userContext } from '../../../context/UserContext'\nimport { toast, ToastContainer } from 'react-toastify';\nimport { useHistory, useParams } from 'react-router-dom'\n\nexport default function Edit() {\n    let { id } = useParams();\n    const history = useHistory();\n    const { user,setLoad } = React.useContext(userContext);\n    const [invoiceNo, setInvoiceNo] = React.useState('');\n    const [saleReturnDate, setSaleReturnDate] = React.useState('');\n    const [default_gst, setDefaultGST]  = React.useState(false);\n    const [currentCustomer, setCurrentCustomer] = React.useState('');\n    const [currentWarehouse, setCurrentWarehouse] = React.useState('');\n    const [discountType, setDiscountType] = React.useState('None');\n    const [discountValue, setDiscountValue] = React.useState(0);\n    const [currentPaymentMethod, setCurrentPaymentMethod] = React.useState({\n        label: \"cash\"\n    })\n    const [currentDiscountCriteria, setCurrentDiscountCriteria] = React.useState('percent');\n    const [currentProduct, setCurrentProduct] = React.useState('');\n    const [finalDiscountValue, setFinalDiscountValue] = React.useState(0);\n    const [finalDiscountCriteria, setFinalDiscountCriteria] = React.useState('percent');\n    const [sale_return_price, setSaleReturnPrice] = React.useState(0);\n    const [gst,setGST] = React.useState({\n        value:0,\n        label:0\n    });\n    const [qty, setQty] = React.useState(1);\n    const [gst_list,setGSTList] = React.useState([]);\n    const [remarks, setRemarks] = React.useState('');\n\n    const [allCustomers, setAllCustomers] = React.useState([]);\n    const [allPaymentMethods, setAllPaymentMethods] = React.useState([]);\n    const [allWarehouses, setAllWarehouses] = React.useState([]);\n    const [allItems, setAllItems] = React.useState([]);\n    const [allProducts,setAllProducts] = React.useState([]);\n\n    //final related variables and states\n    let finalAmount = 0;\n    let remainAmount = 0;\n    let discount_amount_final = 0;\n    let amount_before_discount_final = 0;\n    let amount_after_discount_final = 0;\n\n    const [paidAmount, setPaidAmount] = React.useState(0);\n    const [totalValue, setTotalValue] = React.useState(0);\n    const [discountAmount,setDiscountAmount] = React.useState(0);\n    const [taxAmount,setTaxableAmount] = React.useState(0);\n\n    //edit related states\n    const [currentEditItem, setCurrentEditItem] = React.useState('');\n\n    //item based variables\n    let perItemAmount = 0;\n    let tax_amount = 0;\n    let amount_item = 0;\n    let amount_before_discount = 0;\n    let amount_after_discount = 0;\n    let amount_after_tax=0;\n    let discount_amount = 0;\n\n    React.useEffect(() => {\n        \n        async function fetchPaymentMethods() {\n            setLoad(true);\n            const response = await fetch(url + 'getPaymentMethods', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n            const data = await response.json();\n            setLoad(false);\n            setAllPaymentMethods(data?.payment_methods.map(item => {\n                return {\n                    label: item\n                }\n            }))\n        }\n        fetchPaymentMethods();\n\n        async function fetchDataParty() {\n            setLoad(true);\n            const response = await fetch(url + 'clientlist', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    console.log(data);\n                    setAllCustomers(data?.client_list.map(item => {\n                        return {\n                            value: item.id,\n                            label: item.name,\n                            amount: item.due_amount,\n                        }\n                    }))\n                } else {\n                    toast.error(data.message)\n                }\n            }\n        }\n        fetchDataParty();\n\n        async function fetchGSTList() {\n            setLoad(true);\n            const response = await fetch(url + 'getGSTList', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n            const data = await response.json();\n            setLoad(false);\n            setGSTList(data?.gst.map(item => {\n                return {\n                    value: item,\n                    label: item\n                }\n            }))\n        }\n        fetchGSTList();\n\n        async function fetchWarehouse() {\n            setLoad(true);\n            const response = await fetch(url + 'warehouselist', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    setAllWarehouses(data?.warehouse_list.map(item => {\n                        return {\n                            value: item.id,\n                            label: item.name\n                        }\n                    }))\n                } else {\n                    toast.error(data.message)\n                }\n            }\n        }\n        fetchWarehouse();\n\n        async function fetchDetailSales() {\n            setLoad(true);\n            const response = await fetch(url + 'getSaleReturnById/' + id, {\n                headers: {\n                    'Authorization': user.token\n                }\n            });\n\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    let header = data.sale_return_header;\n                    let final_discount_criteria='';\n                    let final_discount_value = 0;\n                    if (parseFloat(header.bill_discount_percentage)>0) {\n                        final_discount_criteria = 'percent';\n                        final_discount_value = header.bill_discount_percentage;\n                    } else if (parseFloat(header.bill_discount_amount)>0) {\n                        final_discount_criteria = 'amount';\n                        final_discount_value = header.bill_discount_amount\n                    }\n                    let items = data.sale_return_items;\n                    setInvoiceNo(header.invoice_number);\n                    setSaleReturnDate(header.sale_return_date);\n                    setCurrentCustomer({\n                        value: header.customer_id,\n                        label: header.customer_name\n                    });\n                    setCurrentWarehouse({\n                        value: header.warehouse_id,\n                        label: header.warehouse_name\n                    })\n                    fetchProd(header.warehouse_id);\n                    setDiscountType(header.discount_type);\n                    let midItems = [];\n                    for (let i = 0; i < items.length; i++) {\n                        let current_item = items[i]; \n                        let discount_type = '';\n                        let discount_value = 0;\n                        \n                        if (current_item.discount_percent && parseFloat(current_item.discount_percent) > 0) {\n                            discount_type = 'percent'\n                            discount_value = current_item.discount_percent\n                        } else if (current_item.discount_amount) {\n                            discount_type = 'amount';\n                            discount_value = current_item.discount_amount\n                        } else {\n                            //\n                        }\n                        let obj={};\n                        if(header.default_gst===\"true\"){\n                            setDefaultGST(true);\n                            obj = {\n                            item: {\n                                value: current_item.product_id,\n                                label: current_item.product_name,\n                                type: current_item.product_type,\n                                unit: current_item.product_unit,\n                                price: current_item.sale_return_price,\n                                hsbn: current_item.product_hsbn,\n                                serial_no: current_item.product_serial_no\n                            },\n                            item_id: current_item.id,\n                            sale_return_price: current_item.sale_return_price,\n                            qty: current_item.qty,\n                            discount_type: discount_type,\n                            discountValue: discount_value,\n                            gst: {\n                                label: current_item.tax_percent,\n                                value: current_item.tax_percent\n                            },\n                            total: current_item.total,\n                            amount_item: current_item.total,\n                            amount_after_tax: current_item.amount_after_tax,\n                            amount_before_discount: current_item.amount_before_discount,\n                            tax_amount: current_item.tax_amount,\n                            discount_amount: current_item.discount_amount,\n                            amount_after_discount: current_item.amount_after_discount,\n                            warehouse_id : current_item.warehouse_id,\n                            warehouse_name : current_item.warehouse_name\n                        }\n                    }\n                    else{\n                        setDefaultGST(false);\n                        obj = {\n                            item: {\n                                value: current_item.product_id,\n                                label: current_item.product_name,\n                                type: current_item.product_type,\n                                unit: current_item.product_unit,\n                                hsbn: current_item.product_hsbn,\n                                price: current_item.sale_return_price,\n                                serial_no: current_item.product_serial_no\n                            },\n                            item_id: current_item.id,\n                            sale_return_price: current_item.sale_return_price,\n                            qty: current_item.qty,\n                            discount_type: discount_type,\n                            discountValue: discount_value,\n                            gst: {\n                                value:0,\n                                label:0\n                            },\n                            total: current_item.total,\n                            amount_item: current_item.total,\n                            amount_after_tax: current_item.amount_after_tax,\n                            amount_before_discount: current_item.amount_before_discount,\n                            tax_amount: current_item.tax_amount,\n                            discount_amount: current_item.discount_amount,\n                            amount_after_discount: current_item.amount_after_discount,\n                            warehouse_id : current_item.warehouse_id,\n                            warehouse_name : current_item.warehouse_name\n                        }\n                    }\n                        midItems.push(obj)\n                    }\n                    setAllItems(midItems);\n                    let current_total_fetch = 0;\n                    let discount_amount = 0;\n                    let taxable_amount = 0;\n                    midItems.map(item => {\n                        current_total_fetch = parseFloat(current_total_fetch) + parseFloat(item.total)\n                        discount_amount = parseFloat(discount_amount) + parseFloat(item.discount_amount)\n                        taxable_amount = parseFloat(taxable_amount)+ parseFloat(item.tax_amount);\n                    })\n                    setTotalValue(current_total_fetch);\n                    setDiscountAmount(discount_amount);\n                    setTaxableAmount(taxable_amount);\n                    setFinalDiscountValue(final_discount_value);\n                    setFinalDiscountCriteria(final_discount_criteria);\n                    setPaidAmount(header.amount_paid);\n                    setCurrentPaymentMethod({\n                        label: \"cash\"\n                    });\n                    setRemarks(header.remarks);\n                } else {\n                    toast.error(data.message);\n                }\n            }\n        }\n        fetchDetailSales()\n    }, [])\n\n    async function fetchProd(e) {\n        setLoad(true);    \n        const response = await fetch(url + `fetchProducts?warehouse=${e}`, {\n            method: 'GET',\n            headers: {\n                'Authorization': user?.token\n            }\n        })\n        if (response.ok === true) {\n            const data = await response.json();\n            setLoad(false)\n            if (data.status === 200) {\n                let products=[];\n                if(data.inventory_list){\n                  data.inventory_list.map(item=>{\n                    products.push(\n                       {value : item.product_id,\n                        label : item.product_name,\n                        type : \"product\",\n                        unit : item.product_unit,\n                        price: item.sale_unit_price,\n                        hsbn : item.product_hsbn,\n                        serial_no : item.product_serial_no,\n                       }\n                  )})\n                }\n                if(data.product_list){\n                    data.product_list.map(item=>{\n                      products.push(\n                         {value : item.id,   \n                          label : item.name,\n                          type: item.type,\n                          unit: item.unit,\n                          price: item.price,\n                          hsbn : item.hsbn,\n                          serial_no : item.serial_no\n                         }\n                    )})\n                  }  \n                setAllProducts(products);\n            } else {\n                toast.error(data.message)\n            }\n        }\n    }\n\n    const calculateTotal = () => {\n        if (sale_return_price > 0 && qty > 0) {\n            amount_item = parseFloat(sale_return_price) * parseFloat(qty); //amount before tax\n            tax_amount=0;\n            if(default_gst && gst){\n            tax_amount = (parseFloat(amount_item)/100) * parseFloat(gst.value);\n            }\n            amount_after_tax = amount_item + tax_amount;\n            perItemAmount = amount_after_tax;\n\n            if (discountType === 'Item' || discountType === 'Both') {\n                amount_before_discount = amount_after_tax;\n                if (currentDiscountCriteria === 'percent') {\n                    discount_amount = (parseFloat(amount_before_discount) / 100) * parseFloat(discountValue)\n                    amount_after_discount = amount_before_discount - discount_amount;\n                    perItemAmount = amount_after_discount;\n                }\n\n                if (currentDiscountCriteria === 'amount') {\n                    discount_amount = parseFloat(discountValue);\n                    amount_after_discount = amount_before_discount - discount_amount;\n                    perItemAmount = amount_after_discount;\n                }\n            }\n        }\n    }\n\n    calculateTotal()\n\n    const calculateFinalPrice = () => {\n        if (totalValue > 0) {\n            if (discountType === 'Bill' || discountType === 'Both') {\n                if (finalDiscountCriteria === 'percent') {\n                    discount_amount_final = totalValue / 100 * parseFloat(finalDiscountValue);\n                    amount_before_discount_final = totalValue;\n                    amount_after_discount_final = totalValue - discount_amount_final;\n                }\n\n                if (finalDiscountCriteria === 'amount') {\n                    discount_amount_final = parseFloat(finalDiscountValue);\n                    amount_before_discount_final = totalValue;\n                    amount_after_discount_final = totalValue - discount_amount_final;\n                }\n                finalAmount = amount_after_discount_final;\n                remainAmount = finalAmount - parseFloat(paidAmount);\n            } else {\n                finalAmount = totalValue\n                remainAmount = finalAmount - parseFloat(paidAmount);\n            }\n        }\n    }\n\n    calculateFinalPrice()\n\n    const handleSubmitItem = () => {\n        if (invoiceNo && saleReturnDate && currentProduct && currentWarehouse && currentCustomer && sale_return_price && qty) {\n            let new_item_dict = {\n                item: currentProduct,\n                sale_return_price: sale_return_price,\n                qty: qty,\n                gst: gst,\n                discount_type: currentDiscountCriteria,\n                discountValue,\n                total: perItemAmount,\n                amount_item,\n                amount_before_discount,\n                discount_amount,\n                tax_amount,\n                amount_after_discount,\n                warehouse_id : currentWarehouse.value,\n                warehouse_name : currentWarehouse.label\n            };\n            if (currentEditItem) {\n                setCurrentEditItem('')\n                let new_list_edit = []\n                allItems.map((item, index) => {\n                    if (index === parseInt(currentEditItem)-1) {\n                        new_list_edit.push(new_item_dict)\n                    } else {\n                        new_list_edit.push(item)\n                    }\n                })\n                let total = 0;\n                let discount_amount=0;\n                let taxable_amount=0;\n                new_list_edit.map(item=>{\n                    total = parseFloat(total) + parseFloat(item.total);\n                    discount_amount = parseFloat(discount_amount) + parseFloat(item.discount_amount);\n                    taxable_amount = parseFloat(taxable_amount) + parseFloat(item.tax_amount);\n                })\n                setTotalValue(total);\n                setDiscountAmount(discount_amount);\n                setTaxableAmount(taxable_amount);\n                setAllItems(new_list_edit);\n            } else {\n                let new_item_list = [...allItems, new_item_dict];\n                let total = 0;\n                let taxable_amount=0;\n                new_item_list.map(item=>{\n                    total = parseFloat(total) + parseFloat(item.total);\n                    discount_amount = parseFloat(discount_amount) + parseFloat(item.discount_amount);\n                    taxable_amount = parseFloat(taxable_amount) + parseFloat(item.tax_amount);\n                })\n                setDiscountAmount(discount_amount);\n                setTaxableAmount(taxable_amount);\n                setTotalValue(total);\n\n                setTotalValue(parseFloat(totalValue) + parseFloat(perItemAmount))\n                setAllItems(new_item_list);\n            }\n            setCurrentProduct('');\n            setSaleReturnPrice(0);\n            setCurrentDiscountCriteria('');\n            setDiscountValue(0);\n            setQty(1);\n            setGST({\n                label:0,\n                value:0\n            });\n            perItemAmount = 0;\n            amount_item= 0;\n            amount_before_discount = 0;\n            amount_after_discount = 0;\n            discount_amount = 0;\n            tax_amount=0;\n            amount_after_tax=0;\n        } else {\n            toast.error('Fill all fields having *')\n        }\n    }\n\n    const finalSubmit = () => {\n        if (invoiceNo && saleReturnDate && currentWarehouse && currentCustomer && allItems.length > 0 && totalValue){\n            setLoad(true)\n            let header = {\n                invoiceNo : invoiceNo,\n                saleReturnDate : saleReturnDate,\n                currentCustomer : currentCustomer,\n                currentWarehouse : currentWarehouse,\n                discountType : discountType,\n                default_gst: default_gst\n            }\n            let final = {\n                totalValue : totalValue,\n                finalAmount : finalAmount,\n                paidAmount : paidAmount,\n                remainAmount : remainAmount,\n                finalDiscountValue : finalDiscountValue,\n                finalDiscountCriteria : finalDiscountCriteria,\n                remarks : remarks,\n                paymentMethod : currentPaymentMethod.label,\n                discountAmount : discountAmount,\n                taxableAmount : taxAmount\n            }\n\n            let final_array = [];\n\n            final_array.push(header);\n            final_array.push(final);\n\n            const formData = new FormData();\n            formData.append('final_array',JSON.stringify(final_array));\n            formData.append('allItems',JSON.stringify(allItems));\n\n            async function submitSales(){\n                const response = await fetch(url + 'updateSaleReturn/' + id,{\n                    method : 'POST',\n                    headers : {\n                        'Authorization' : user.token\n                    },\n                    body : formData\n                });\n                if (response.ok === true){\n                    const data = await response.json();\n                    setLoad(false)\n                    if (data.status === 200){\n                        toast.success(data.message);\n                        history.push('/salesReturnReport')\n                    }else{\n                        toast.error(data.message);\n                    }\n                }\n            }\n            submitSales()\n        }else{\n            toast.error('Please fill the data with *');\n        }\n    }\n\n    const handleEdit = (item, index_value) => {\n        setCurrentEditItem(index_value);\n        setCurrentProduct(item.item);\n        setSaleReturnPrice(item.sale_return_price);\n        setQty(item.qty);\n        setGST(item.gst);\n        setCurrentDiscountCriteria(item.discount_type);\n        setDiscountValue(item.discountValue);\n        perItemAmount = item.total;\n    }\n\n    const handleDelete = (index_value) => {\n        const new_item = [];\n        allItems.map((item, index) => {\n            if (index !== index_value) {\n                new_item.push(item)\n            }\n        })\n        let total = 0;\n        let discount_amount = 0;\n        let taxable_amount = 0;\n        new_item.map(item => {\n            total = parseFloat(total) + parseFloat(item.total);\n            discount_amount = parseFloat(discount_amount) + parseFloat(item.discount_amount)\n            taxable_amount = parseFloat(taxable_amount) + parseFloat(item.tax_amount)\n        })\n        setDiscountAmount(discount_amount);\n        setTaxableAmount(taxable_amount);\n        setTotalValue(total);\n        setAllItems(new_item);\n    }\n    const handleProduct=(e)=>{\n        setCurrentProduct(e);\n        setSaleReturnPrice(e.price);\n    }\n\n    return (\n        <div className=\"container full-size-create-page-main-section\">\n            <ToastContainer />\n            <form>\n                <div className='p-sm-5 px-md-3 create-form-field create-purchase-page'>\n                    <div class=\"py-4 px-2 form-row create-purchase-header\">\n                        <div class=\"form-group col-md-3\">\n                            <label for=\"invoice-number\">Invoice No.<span className='required-label'>*</span></label>\n                            <input readOnly value={invoiceNo} type=\"text\" class=\"form-control\" id=\"invoice-number\" required />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"input-party\">Warehouse<span className='required-label'>*</span></label>\n                            <Select readOnly options={allWarehouses} value={currentWarehouse} />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"date\">Sale Return Date</label>\n                            <input value={saleReturnDate} onChange={e => setSaleReturnDate(e.target.value)} type=\"date\" class=\"form-control\" id=\"date\" />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"input-party\">Customer<span className='required-label'>*</span></label>\n                            <Select options={allCustomers} value={currentCustomer} />\n                        </div>\n                        <div class=\"form-group my-md-3 col-md-4\">\n                            <div className=\"text-center mb-2 font-weight-bold\">\n                                <label for=\"input-party\">Discount Type<span className='required-label'>*</span></label>\n                            </div>\n                            <div className='row px-3'>\n                                <div class=\"form-check col-sm-3\">\n                                    <input checked={discountType === 'None' && true} onClick={() => setDiscountType('None')} class=\"form-check-input\" name=\"discount\" type=\"radio\" value=\"\" id=\"defaultCheck1\" />\n                                    <label class=\"form-check-label\" for=\"defaultCheck1\">\n                                        None\n                                    </label>\n                                </div>\n                                <div class=\"form-check col-sm-3\">\n                                    <input checked={discountType === 'Item' && true} onClick={() => setDiscountType('Item')} class=\"form-check-input\" name=\"discount\" type=\"radio\" value=\"\" id=\"defaultCheck2\" />\n                                    <label class=\"form-check-label\" for=\"defaultCheck2\">\n                                        Item\n                                </label>\n                                </div>\n                                <div class=\"form-check col-sm-3\">\n                                    <input checked={discountType === 'Bill' && true} onClick={() => setDiscountType('Bill')} class=\"form-check-input\" name=\"discount\" type=\"radio\" value=\"\" id=\"defaultCheck3\" />\n                                    <label class=\"form-check-label\" for=\"defaultCheck3\">\n                                        Bill\n                                </label>\n                                </div>\n                                <div class=\"form-check col-sm-3\">\n                                    <input checked={discountType === 'Both' && true} onClick={() => setDiscountType('Both')} class=\"form-check-input\" name=\"discount\" type=\"radio\" value=\"\" id=\"defaultCheck3\" />\n                                    <label class=\"form-check-label\" for=\"defaultCheck3\">\n                                        Both\n                                </label>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"form-group col-md-2\">\n                        <label for=\"inputPassword\" class=\"col-sm-2 col-form-label\">GST:</label>\n                        <div class=\"d-flex b-0 col-sm-1\">\n                        <input readOnly checked={default_gst} type=\"checkbox\" id=\"inputPassword\" />\n                        </div>\n                        </div>\n                    </div>    \n                    <div class=\"my-4 form-row\">\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"invoice-number\">Item<span className='required-label'>*</span></label>\n                            <Select options={allProducts} value={currentProduct} onChange={(e)=>handleProduct(e)} />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"invoice-number\">Price<span className='required-label'>*</span></label>\n                            <input value={sale_return_price} onChange={(e) => setSaleReturnPrice(e.target.value)} type=\"text\" class=\"form-control\" id=\"\" />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"invoice-number\">Quantity{currentProduct ? ` (${currentProduct.unit})` :null}<span className='required-label'>*</span></label>\n                            <input value={qty} onChange={e => setQty(e.target.value)} type=\"text\" class=\"form-control\" id=\"\" />\n                        </div>\n                        \n                        {default_gst && <div class=\"form-group col-md-4\">\n                            <label for=\"invoice-number\">GST:<span className='required-label'>*</span></label>\n                            <Select options={gst_list} value={gst} onChange={setGST} />\n                        </div>}\n                        {discountType === 'Item' &&\n                            <div className='form-group col-md-4'>\n                                <label htmlFor=\"\">Discount</label>\n                                <div className='m-0 p-0 col-12 row'>\n                                    <div className=\"px-0 col-5\">\n                                        <input value={discountValue} onChange={e => setDiscountValue(e.target.value)} class=\"form-control\" type=\"text\" name=\"\" id=\"\" />\n                                    </div>\n                                    <div className=\"p-0 col-7\">\n                                        <select value={currentDiscountCriteria} onChange={e => setCurrentDiscountCriteria(e.target.value)} class=\"form-control\" required>\n                                            <option value=\"\">Select Type</option>\n                                            <option value='percent'>Percent</option>\n                                            <option value='amount'>Amount</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>\n                        }\n                        {discountType === 'Both' &&\n                            <div className='form-group col-md-4'>\n                                <label htmlFor=\"\">Discount</label>\n                                <div className='m-0 p-0 col-12 row'>\n                                    <div className=\"px-0 col-5\">\n                                        <input value={discountValue} onChange={e => setDiscountValue(e.target.value)} class=\"form-control\" type=\"text\" name=\"\" id=\"\" />\n                                    </div>\n                                    <div className=\"p-0 col-7\">\n                                        <select value={currentDiscountCriteria} onChange={e => setCurrentDiscountCriteria(e.target.value)} class=\"form-control\" required>\n                                            <option value=\"\">Select Type</option>\n                                            <option value='percent'>Percent</option>\n                                            <option value='amount'>Amount</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>\n                        }\n                        <div class=\"form-group col-md-4 row\">\n                            <div class=\"form-group col-9\">\n                                <label for=\"invoice-number\">Total<span className='required-label'>*</span></label>\n                                <input value={perItemAmount} readOnly type=\"text\" class=\"form-control\" id=\"\" />\n                            </div>\n                            <div class=\"form-group col-3 p-0 purchase-create-mid-plus-img\">\n                                <img className='img-fluid' onClick={() => handleSubmitItem()} style={{ cursor: 'pointer' }} src={plus} alt=\"\" />\n                            </div>\n                        </div>\n                    </div>\n\n                    {allItems.length > 0 && <div className='my-table-responsive'>\n                        <table class=\"table mt-4\">\n                            <thead class=\"thead-dark\">\n                                <tr>\n                                    <th scope=\"col\">Item</th>\n                                    <th scope=\"col\">Price</th>\n                                    <th scope=\"col\">Quantity</th>\n                                    <th scope=\"col\">GST</th>\n                                    <th scope=\"col\">Discount</th>\n                                    <th scope=\"col\">Total</th>\n                                    <th>Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody className='table-borderless'>\n                                {allItems.map((item, index) => {\n                                    return (\n                                        <tr>\n                                            <td>\n                                                <p className='p-0 m-0'>{item.item.label}</p>\n                                                <p>({item.warehouse_name})</p>\n                                            </td>\n                                            <td>{item.sale_return_price}</td>\n                                            <td>{item.qty}</td>\n                                            <td>{item.gst.value}%</td>\n                                            <td>{item.discountValue} {item.discount_type}</td>\n                                            <td>{item.total}</td>\n                                            <td>\n                                                <i style={{ cursor: 'pointer' }} onClick={() => handleEdit(item, index+1)} class=\"fa fa-pencil\" aria-hidden=\"true\"></i>\n                                                <i onClick={() => handleDelete(index)} style={{ cursor: \"pointer\" }} class=\"fa fa-trash\" aria-hidden=\"true\"></i>\n                                            </td>\n                                        </tr>\n                                    )\n                                })}\n                            </tbody>\n                        </table>\n                    </div>}\n                    <div className='row mt-5 justify-content-between purchase-create-footer'>\n                        <div class=\"form-group col-md-5\">\n                            <label for=\"exampleFormControlTextarea1\">Remarks</label>\n                            <textarea value={remarks} onChange={e => setRemarks(e.target.value)} class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"5\"></textarea>\n                        </div>\n                        <div className='col-md-6'>\n                            <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Total Value</label>\n                                <div class=\"col-md-8\">\n                                    <input type=\"text\" value={totalValue} class=\"form-control\" id=\"\" />\n                                </div>\n                            </div>\n                            {discountType === 'Bill' && <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Discount</label>\n                                <div class=\"pr-0 col-md-8 row\">\n                                    <div className=\"pr-0 col-5\">\n                                        <input class=\"form-control\" value={finalDiscountValue} onChange={e => setFinalDiscountValue(e.target.value)} type=\"text\" name=\"\" id=\"\" />\n                                    </div>\n                                    <div className=\"px-0 col-7\">\n                                        <select value={finalDiscountCriteria} onChange={e => setFinalDiscountCriteria(e.target.value)} class=\"form-control\" required>\n                                            <option value=\"\">Select Type</option>\n                                            <option value='percent'>Percent</option>\n                                            <option value='amount'>Amount</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>}\n                            {discountType === 'Both' && <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Discount</label>\n                                <div class=\"pr-0 col-md-8 row\">\n                                    <div className=\"pr-0 col-5\">\n                                        <input class=\"form-control\" type=\"text\" value={finalDiscountValue} onChange={e => setFinalDiscountValue(e.target.value)} />\n                                    </div>\n                                    <div className=\"px-0 col-7\">\n                                        <select value={finalDiscountCriteria} onChange={e => setFinalDiscountCriteria(e.target.value)} class=\"form-control\" required>\n                                            <option value=\"\">Select Type</option>\n                                            <option value='percent'>Percent</option>\n                                            <option value='amount'>Amount</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>}\n                            <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Final Amount</label>\n                                <div class=\"col-md-8\">\n                                    <input readOnly value={finalAmount} type=\"text\" class=\"form-control\" id=\"\" />\n                                </div>\n                            </div>\n                            <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Paid Amount</label>\n                                <div class=\"col-md-8\">\n                                    <input value={paidAmount} type=\"text\" class=\"form-control\" id=\"\" />\n                                </div>\n                            </div>\n                            {paidAmount > 0 && <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Payment Method</label>\n                                <div class=\"col-md-8\">\n                                    <Select options={allPaymentMethods} value={currentPaymentMethod}/>\n                                </div>\n                            </div>}\n                            <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Remain Amount</label>\n                                <div class=\"col-md-8\">\n                                    <input type=\"text\" value={remainAmount} readOnly class=\"form-control\" id=\"\" />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"d-flex justify-content-center create-catagory-btns\">\n                    <button type=\"button\" onClick={() => window.location.reload()} class=\"font-weight-bold m-3 py-2 px-4 btn btn-danger\">Cancel<i\n                        class=\"px-2 fa fa-times\" aria-hidden=\"true\"></i></button>\n                    <button type=\"button\" onClick={()=>finalSubmit()} class=\"font-weight-bold m-3 py-2 px-4 btn btn-success\">Save<i\n                        class=\"px-2 fa fa-floppy-o\" aria-hidden=\"true\"></i></button>\n                </div>\n            </form>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}