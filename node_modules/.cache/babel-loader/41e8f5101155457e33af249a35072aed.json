{"ast":null,"code":"import _asyncToGenerator from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{Fragment}from'react';import ReactDatatable from'@ashvin27/react-datatable';import Select from'react-select';import{url}from'src/helpers/helpers';import{toast,ToastContainer}from'react-toastify';import{userContext}from'../../context/UserContext';import InventoryAdjustModal from'src/components/InventoryAdjustModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Index(){var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),id=_React$useState2[0],setId=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),showModal=_React$useState4[0],setShowModal=_React$useState4[1];var _React$useContext=React.useContext(userContext),user=_React$useContext.user,setLoad=_React$useContext.setLoad;var _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),inventoryList=_React$useState6[0],setInventoryList=_React$useState6[1];var _React$useState7=React.useState(0),_React$useState8=_slicedToArray(_React$useState7,2),adjustAmount=_React$useState8[0],setAdjustAmount=_React$useState8[1];var _React$useState9=React.useState(0),_React$useState10=_slicedToArray(_React$useState9,2),total=_React$useState10[0],setTotal=_React$useState10[1];var _React$useState11=React.useState([]),_React$useState12=_slicedToArray(_React$useState11,2),allWarehouses=_React$useState12[0],setAllWarehouses=_React$useState12[1];var _React$useState13=React.useState(''),_React$useState14=_slicedToArray(_React$useState13,2),currentWarehouse=_React$useState14[0],setCurrentWarehouse=_React$useState14[1];var _React$useState15=React.useState([]),_React$useState16=_slicedToArray(_React$useState15,2),allProducts=_React$useState16[0],setAllProducts=_React$useState16[1];var _React$useState17=React.useState(''),_React$useState18=_slicedToArray(_React$useState17,2),currentProduct=_React$useState18[0],setCurrentProduct=_React$useState18[1];var showModalFunc=function showModalFunc(id){setId(id);setShowModal(true);};var submitAdjust=function submitAdjust(){setLoad(true);var formData=new FormData();formData.append('new_qty',adjustAmount);function editData(){return _editData.apply(this,arguments);}function _editData(){_editData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var respone,data,_fetchData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(url+'updateInventory/'+id,{method:'POST',headers:{'Authorization':user.token},body:formData});case 2:respone=_context2.sent;if(!(respone.ok===true)){_context2.next=9;break;}_context2.next=6;return respone.json();case 6:data=_context2.sent;setLoad(false);if(data.status===200){_fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(url+'fetchInventoryReport',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context.sent;if(!(response.ok===true)){_context.next=8;break;}_context.next=6;return response.json();case 6:_data=_context.sent;if(_data.status===200){setInventoryList(_data.list.map(function(item,index){return{'#':index+1,'id':item.id,'product_name':item.product_name,'warehouse_name':item.warehouse_name,'sale_unit_price':item.sale_unit_price,'total_qty':item.total_qty};}));setTotal(parseInt(_data.total_records));}else{toast.error(_data.message);}case 8:case\"end\":return _context.stop();}}},_callee);}));return function _fetchData(){return _ref.apply(this,arguments);};}();setId('');setAdjustAmount('');setShowModal(false);_fetchData();}else{toast.error(data.message);}case 9:case\"end\":return _context2.stop();}}},_callee2);}));return _editData.apply(this,arguments);}editData();};function handleSubmit(e){e.preventDefault();var string=\"\";if(currentWarehouse&&currentProduct){string=\"product=\".concat(currentProduct.label,\"&warehouse=\").concat(currentWarehouse.label);}else if(currentWarehouse){string=\"warehouse=\".concat(currentWarehouse.label);}else if(currentProduct){string=\"product=\".concat(currentProduct.label);}setLoad(true);function submit(){return _submit.apply(this,arguments);}function _submit(){_submit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(url+\"fetchInventoryReport?\".concat(string),{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context3.sent;if(!(response.ok===true)){_context3.next=11;break;}_context3.next=6;return response.json();case 6:data=_context3.sent;setLoad(false);if(data.status===200){setInventoryList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'product_name':item.product_name,'warehouse_name':item.warehouse_name,'sale_unit_price':item.sale_unit_price,'total_qty':item.total_qty};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}_context3.next=12;break;case 11:toast.error('Oops something went wrong!');case 12:case\"end\":return _context3.stop();}}},_callee3);}));return _submit.apply(this,arguments);}submit().catch(function(err){return toast.error('Internal server error!. Please try again later');});}React.useEffect(function(){setLoad(true);function fetchWarehouse(){return _fetchWarehouse.apply(this,arguments);}function _fetchWarehouse(){_fetchWarehouse=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setLoad(true);_context4.next=3;return fetch(url+'warehouselist',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context4.sent;if(!(response.ok===true)){_context4.next=10;break;}_context4.next=7;return response.json();case 7:data=_context4.sent;setLoad(false);if(data.status===200){setAllWarehouses(data===null||data===void 0?void 0:data.warehouse_list.map(function(item){return{value:item.id,label:item.name};}));}else{toast.error(data.message);}case 10:case\"end\":return _context4.stop();}}},_callee4);}));return _fetchWarehouse.apply(this,arguments);}fetchWarehouse();function fetchProd(){return _fetchProd.apply(this,arguments);}function _fetchProd(){_fetchProd=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var response,data,_data$product_list;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setLoad(true);_context5.next=3;return fetch(url+'fetchInventoryProducts',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context5.sent;if(!(response.ok===true)){_context5.next=10;break;}_context5.next=7;return response.json();case 7:data=_context5.sent;setLoad(false);if(data.status===200){setAllProducts(data===null||data===void 0?void 0:(_data$product_list=data.product_list)===null||_data$product_list===void 0?void 0:_data$product_list.map(function(item){return{value:item.product_id,label:item.product_name};}));}else{toast.error(data.message);}case 10:case\"end\":return _context5.stop();}}},_callee5);}));return _fetchProd.apply(this,arguments);}fetchProd();function fetchData(){return _fetchData2.apply(this,arguments);}function _fetchData2(){_fetchData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var response,data;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return fetch(url+'fetchInventoryReport',{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 2:response=_context6.sent;if(!(response.ok===true)){_context6.next=9;break;}_context6.next=6;return response.json();case 6:data=_context6.sent;setLoad(false);if(data.status===200){setInventoryList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'product_name':item.product_name,'warehouse_name':item.warehouse_name,'sale_unit_price':item.sale_unit_price,'total_qty':item.total_qty};}));setTotal(parseInt(data.total_records));}case 9:case\"end\":return _context6.stop();}}},_callee6);}));return _fetchData2.apply(this,arguments);}fetchData();},[]);var columns=[{key:\"#\",text:\"#\",className:\"#\",sortable:false},{key:\"product_name\",text:\"Product\",className:\"product_name\",sortable:true},{key:\"warehouse_name\",text:\"Warehouse\",className:\"warehouse_name\",sortable:true},{key:\"sale_unit_price\",text:\"Price\",className:\"sale_unit_price\",sortable:true},{key:\"total_qty\",text:\"Available Qty\",className:\"total_qty\",sortable:true},{key:\"action\",text:\"Action\",className:\"action\",width:100,sortable:false,cell:function cell(record){return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"i\",{style:{cursor:'pointer'},onClick:function onClick(){return showModalFunc(record.id);},class:\"fa fa-pencil mr-1\",\"aria-hidden\":\"true\"})});}}];var config={page_size:10,length_menu:[10,20,50],button:{excel:false,print:false,extra:false}};function fetchData(_x){return _fetchData3.apply(this,arguments);}function _fetchData3(){_fetchData3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(query){var response,data;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:setLoad(true);_context7.next=3;return fetch(url+query,{method:'GET',headers:{'Authorization':user===null||user===void 0?void 0:user.token}});case 3:response=_context7.sent;if(!(response.ok===true)){_context7.next=10;break;}_context7.next=7;return response.json();case 7:data=_context7.sent;setLoad(false);if(data.status===200){setInventoryList(data.list.map(function(item,index){return{'#':index+1,'id':item.id,'product_name':item.product_name,'warehouse_name':item.warehouse_name,'sale_unit_price':item.sale_unit_price,'total_qty':item.total_qty};}));setTotal(parseInt(data.total_records));}else{toast.error(data.message);}case 10:case\"end\":return _context7.stop();}}},_callee7);}));return _fetchData3.apply(this,arguments);}var handleChange=function handleChange(e){var string=\"\";if(currentWarehouse&&currentProduct){string=\"&product=\".concat(currentProduct.label,\"&warehouse=\").concat(currentWarehouse.label);}else if(currentWarehouse){string=\"&warehouse=\".concat(currentWarehouse.label);}else if(currentProduct){string=\"&product=\".concat(currentProduct.label);}var query=\"fetchInventoryReport?page_number=\".concat(e.page_number,\"&page_size=\").concat(e.page_size,\"&filter_value=\").concat(e.filter_value).concat(string);if(e.sort_order){var sort=JSON.stringify(e.sort_order);query=\"fetchInventoryReport?page_number=\".concat(e.page_number,\"&page_size=\").concat(e.page_size,\"&filter_value=\").concat(e.filter_value,\"&sort_order=\").concat(sort).concat(string);}fetchData(query);};return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsx(InventoryAdjustModal,{header:\"Adjust Inventory\",Label:\"New Quantity\",showModal:showModal,setShowModal:setShowModal,adjutAmount:adjustAmount,setAdjustAmount:setAdjustAmount,submitAdjust:submitAdjust}),/*#__PURE__*/_jsx(\"form\",{onSubmit:function onSubmit(e){return handleSubmit(e);},children:/*#__PURE__*/_jsxs(\"div\",{class:\"form-row create-purchase-header\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"date\",children:\"Warehouse\"}),/*#__PURE__*/_jsx(Select,{options:allWarehouses,value:currentWarehouse,onChange:setCurrentWarehouse})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"form-group col-md-3\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"date\",children:\"Product\"}),/*#__PURE__*/_jsx(Select,{options:allProducts,value:currentProduct,onChange:setCurrentProduct})]}),/*#__PURE__*/_jsx(\"div\",{class:\"form-group col-md-3\",children:/*#__PURE__*/_jsx(\"button\",{type:\"Submit\",class:\"font-weight-bold my-4 py-2 px-4 btn btn-success\",children:\"Filter\"})})]})}),/*#__PURE__*/_jsx(ReactDatatable,{config:config,records:inventoryList,columns:columns,total_record:total,onChange:function onChange(e){return handleChange(e);},dynamic:true})]});}","map":{"version":3,"sources":["/Users/alihussainkabri/Downloads/projects/old projects/erp2.0/erp-2.0/frontend/src/screens/Reports/InventoryReport.js"],"names":["React","Fragment","ReactDatatable","Select","url","toast","ToastContainer","userContext","InventoryAdjustModal","Index","useState","id","setId","showModal","setShowModal","useContext","user","setLoad","inventoryList","setInventoryList","adjustAmount","setAdjustAmount","total","setTotal","allWarehouses","setAllWarehouses","currentWarehouse","setCurrentWarehouse","allProducts","setAllProducts","currentProduct","setCurrentProduct","showModalFunc","submitAdjust","formData","FormData","append","editData","fetch","method","headers","token","body","respone","ok","json","data","status","fetchData","response","list","map","item","index","product_name","warehouse_name","sale_unit_price","total_qty","parseInt","total_records","error","message","handleSubmit","e","preventDefault","string","label","submit","catch","err","useEffect","fetchWarehouse","warehouse_list","value","name","fetchProd","product_list","product_id","columns","key","text","className","sortable","width","cell","record","cursor","config","page_size","length_menu","button","excel","print","extra","query","handleChange","page_number","filter_value","sort_order","sort","JSON","stringify"],"mappings":"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","sourcesContent":["import React,{Fragment} from 'react';\nimport ReactDatatable from '@ashvin27/react-datatable';\nimport Select from 'react-select';\nimport { url } from 'src/helpers/helpers';\nimport { toast, ToastContainer } from 'react-toastify'\nimport { userContext } from '../../context/UserContext'\nimport InventoryAdjustModal from 'src/components/InventoryAdjustModal';\n\nexport default function Index() {\n  const [id, setId] = React.useState(null);\n  const [showModal, setShowModal] = React.useState(false)\n  const { user,setLoad } = React.useContext(userContext);\n  const [inventoryList, setInventoryList] = React.useState([]);\n  const [adjustAmount,setAdjustAmount] = React.useState(0);\n  const [total,setTotal] = React.useState(0); \n  const [allWarehouses, setAllWarehouses] = React.useState([]);\n  const [currentWarehouse, setCurrentWarehouse] = React.useState('');\n  const [allProducts,setAllProducts] = React.useState([]);\n  const [currentProduct, setCurrentProduct] = React.useState('');\n\nconst showModalFunc = (id) => {\n    setId(id);\n    setShowModal(true);\n}\n\nconst submitAdjust = () => {\n    setLoad(true)\n    const formData = new FormData();\n    formData.append('new_qty',adjustAmount);\n    async function editData(){\n        \n        const respone = await fetch(url + 'updateInventory/' + id,{\n            method : 'POST',\n            headers : {\n                'Authorization' : user.token,\n            },\n            body : formData\n        })\n\n        if (respone.ok === true){\n            const data = await respone.json();\n            setLoad(false)\n            if (data.status === 200){\n                setId('');\n                setAdjustAmount('');\n                setShowModal(false);\n                async function fetchData() {\n                    const response = await fetch(url + 'fetchInventoryReport', {\n                        method: 'GET',\n                        headers: {\n                            'Authorization': user?.token\n                        }\n                    })\n        \n                    if (response.ok === true) {\n                        const data = await response.json();\n        \n                        if (data.status === 200) {\n                            setInventoryList(data.list.map((item, index) => {\n                                return {\n                                  '#': index + 1,\n                                  'id': item.id,\n                                  'product_name': item.product_name,\n                                  'warehouse_name': item.warehouse_name,\n                                  'sale_unit_price': item.sale_unit_price,\n                                  'total_qty': item.total_qty,\n                                }\n                              }));\n                              setTotal(parseInt(data.total_records));\n                        } else {\n                            toast.error(data.message);\n                        }\n                    }\n                }\n                fetchData();\n            }else{\n                toast.error(data.message)\n            }\n        }\n    }\n    editData();\n}\n\nfunction handleSubmit(e){\n   e.preventDefault(); \n   let string=\"\";\n    if(currentWarehouse && currentProduct){\n       string=`product=${currentProduct.label}&warehouse=${currentWarehouse.label}`;\n    }\n    else if(currentWarehouse){\n       string=`warehouse=${currentWarehouse.label}`; \n    }\n    else if(currentProduct){\n        string=`product=${currentProduct.label}`;\n    }    \n      setLoad(true);\n      async function submit(){\n          const response = await fetch(url + `fetchInventoryReport?${string}`,{\n              method : 'GET',\n              headers : {\n                  'Authorization' : user?.token\n              }\n          });\n           \n          if (response.ok === true){\n              const data = await response.json();\n              setLoad(false);\n              if (data.status === 200){\n                setInventoryList(data.list.map((item, index) => {\n                  return {\n                    '#': index + 1,\n                    'id': item.id,\n                    'product_name': item.product_name,\n                    'warehouse_name': item.warehouse_name,\n                    'sale_unit_price': item.sale_unit_price,\n                    'total_qty': item.total_qty,\n                  }\n                }));\n                setTotal(parseInt(data.total_records));\n              }else{\n                  toast.error(data.message)\n              }\n          }else{\n              toast.error('Oops something went wrong!')\n          }\n      }\n      submit().catch(err=>toast.error('Internal server error!. Please try again later'))\n }\n\n  React.useEffect(() => {\n    setLoad(true)\n\n    async function fetchWarehouse() {\n      setLoad(true);\n      const response = await fetch(url + 'warehouselist', {\n          method: 'GET',\n          headers: {\n              'Authorization': user?.token\n          }\n      })\n\n      if (response.ok === true) {\n          const data = await response.json();\n          setLoad(false)\n          if (data.status === 200) {\n              setAllWarehouses(data?.warehouse_list.map(item => {\n                  return {\n                      value: item.id,\n                      label: item.name\n                  }\n              }))\n          } else {\n              toast.error(data.message)\n          }\n        }\n      }\n    fetchWarehouse();\n\n    async function fetchProd() {\n      setLoad(true);\n      const response = await fetch(url + 'fetchInventoryProducts', {\n          method: 'GET',\n          headers: {\n              'Authorization': user?.token\n          }\n      })\n\n      if (response.ok === true) {\n          const data = await response.json();\n          setLoad(false)\n          if (data.status === 200) {\n              setAllProducts(data?.product_list?.map(item=>{\n                  return {\n                      value : item.product_id,\n                      label : item.product_name,\n                  }\n              }))\n          } else {\n              toast.error(data.message)\n          }\n        }\n      }\n      fetchProd();\n\n    async function fetchData() {\n      const response = await fetch(url + 'fetchInventoryReport', {\n        method: 'GET',\n        headers: {\n          'Authorization': user?.token\n        }\n      })\n      if(response.ok === true) {\n        const data = await response.json();\n        setLoad(false)\n        if (data.status === 200) {\n            setInventoryList(data.list.map((item, index) => {\n                return {\n                  '#': index + 1,\n                  'id': item.id,\n                  'product_name': item.product_name,\n                  'warehouse_name': item.warehouse_name,\n                  'sale_unit_price': item.sale_unit_price,\n                  'total_qty': item.total_qty,\n                }\n              }));\n              setTotal(parseInt(data.total_records));\n        }\n      }\n    }\n    fetchData();\n  }, [])\n  \n  const columns = [\n    {\n        key: \"#\",\n        text: \"#\",\n        className: \"#\",\n        sortable: false,\n    },\n    {\n        key: \"product_name\",\n        text: \"Product\",\n        className: \"product_name\",\n        sortable: true\n    },\n    {\n        key: \"warehouse_name\",\n        text: \"Warehouse\",\n        className: \"warehouse_name\",\n        sortable: true\n    },\n    {\n        key: \"sale_unit_price\",\n        text: \"Price\",\n        className: \"sale_unit_price\",\n        sortable: true\n    },\n    {\n        key: \"total_qty\",\n        text: \"Available Qty\",\n        className: \"total_qty\",\n        sortable: true\n    },\n    {\n        key: \"action\",\n        text: \"Action\",\n        className: \"action\",\n        width: 100,\n        sortable: false,\n        cell: record => { \n            return (\n                <Fragment>     \n                    <i style={{cursor:'pointer'}} \n                       onClick={()=>showModalFunc(record.id)} \n                       class=\"fa fa-pencil mr-1\" aria-hidden=\"true\">\n                    </i>\n                </Fragment>\n            );\n        }\n    }\n];\n\nconst config = {\n    page_size: 10,\n    length_menu: [ 10, 20, 50 ],\n    button: {\n        excel: false,\n        print: false,\n        extra: false,\n    }\n}\n  async function fetchData(query) {\n    setLoad(true);\n    const response = await fetch(url + query, {\n        method: 'GET',\n        headers: {\n            'Authorization': user?.token\n        }\n    })\n    if (response.ok === true) {\n        const data = await response.json();\n        setLoad(false)\n        if (data.status === 200) {\n          setInventoryList(data.list.map((item, index) => {\n            return {\n              '#': index + 1,\n              'id': item.id,\n              'product_name': item.product_name,\n              'warehouse_name': item.warehouse_name,\n              'sale_unit_price': item.sale_unit_price,\n              'total_qty': item.total_qty,\n            }\n          }));\n          setTotal(parseInt(data.total_records));\n        } else {\n            toast.error(data.message);\n        }\n    }\n}\nconst handleChange=(e)=>{\n    let string=\"\";\n    \n    if(currentWarehouse && currentProduct){\n       string=`&product=${currentProduct.label}&warehouse=${currentWarehouse.label}`;\n    }\n    else if(currentWarehouse){\n       string=`&warehouse=${currentWarehouse.label}`; \n    }\n    else if(currentProduct){\n        string=`&product=${currentProduct.label}`;\n    }\n\n  let query=`fetchInventoryReport?page_number=${e.page_number}&page_size=${e.page_size}&filter_value=${e.filter_value}${string}`;\n  if(e.sort_order){\n      let sort = JSON.stringify(e.sort_order);\n      query=`fetchInventoryReport?page_number=${e.page_number}&page_size=${e.page_size}&filter_value=${e.filter_value}&sort_order=${sort}${string}`;\n  }\n  fetchData(query);\n}\n\n  return (\n    <section>\n      <ToastContainer />\n      <InventoryAdjustModal header=\"Adjust Inventory\" Label = \"New Quantity\" showModal={showModal} setShowModal={setShowModal} adjutAmount={adjustAmount} setAdjustAmount={setAdjustAmount} submitAdjust={submitAdjust} />\n            <form onSubmit={(e)=>handleSubmit(e)}>\n            <div class=\"form-row create-purchase-header\">\n            <div class=\"form-group col-md-3\">\n            <label for=\"date\">Warehouse</label>\n            <Select options={allWarehouses} value={currentWarehouse} onChange={setCurrentWarehouse} />\n            </div>\n            <div class=\"form-group col-md-3\">\n            <label for=\"date\">Product</label>\n            <Select options={allProducts} value={currentProduct} onChange={setCurrentProduct} />\n            </div>\n            <div class=\"form-group col-md-3\">\n            <button type=\"Submit\" class=\"font-weight-bold my-4 py-2 px-4 btn btn-success\">Filter</button>\n            </div>\n            </div>\n            </form>\n      <ReactDatatable\n          config={config}\n          records={inventoryList}\n          columns={columns}\n          total_record={total}\n          onChange={(e)=>handleChange(e)}\n          dynamic={true}\n        />\n    </section>\n  )\n}"]},"metadata":{},"sourceType":"module"}