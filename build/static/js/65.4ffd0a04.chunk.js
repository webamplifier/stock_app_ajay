(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[65],{671:function(e,t,c){"use strict";t.a=c.p+"static/media/add.b7874215.svg"},853:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return m}));var a=c(673),s=c(664),n=c(128),r=c(665),l=c.n(r),o=c(1),i=c.n(o),u=c(671),d=c(670),j=c(663),b=c(100),p=c(667),h=c(18);function m(){var e=i.a.useContext(b.b),t=e.user,c=e.setLoad,r=i.a.useState(""),o=Object(n.a)(r,2),m=o[0],f=o[1],x=i.a.useState(""),O=Object(n.a)(x,2),v=O[0],g=O[1],y=i.a.useState(!1),k=Object(n.a)(y,2),C=k[0],N=k[1],w=i.a.useState(""),S=Object(n.a)(w,2),F=S[0],_=S[1],q=i.a.useState("None"),A=Object(n.a)(q,2),T=A[0],D=A[1],P=i.a.useState(0),B=Object(n.a)(P,2),I=B[0],G=B[1],Q=i.a.useState("percent"),z=Object(n.a)(Q,2),V=z[0],E=z[1],J=i.a.useState(""),L=Object(n.a)(J,2),M=L[0],R=L[1],H=i.a.useState(0),K=Object(n.a)(H,2),U=K[0],W=K[1],X=i.a.useState("percent"),Y=Object(n.a)(X,2),Z=Y[0],$=Y[1],ee=i.a.useState(0),te=Object(n.a)(ee,2),ce=te[0],ae=te[1],se=i.a.useState({value:0,label:0}),ne=Object(n.a)(se,2),re=ne[0],le=ne[1],oe=i.a.useState(1),ie=Object(n.a)(oe,2),ue=ie[0],de=ie[1],je=i.a.useState([]),be=Object(n.a)(je,2),pe=be[0],he=be[1],me=i.a.useState(""),fe=Object(n.a)(me,2),xe=fe[0],Oe=fe[1],ve=i.a.useState([]),ge=Object(n.a)(ve,2),ye=ge[0],ke=ge[1],Ce=i.a.useState([]),Ne=Object(n.a)(Ce,2),we=Ne[0],Se=Ne[1],Fe=i.a.useState([]),_e=Object(n.a)(Fe,2),qe=_e[0],Ae=_e[1],Te=0,De=0,Pe=0,Be=0,Ie=i.a.useState(0),Ge=Object(n.a)(Ie,2),Qe=Ge[0],ze=Ge[1],Ve=i.a.useState("cash"),Ee=Object(n.a)(Ve,2),Je=Ee[0],Le=Ee[1],Me=i.a.useState(0),Re=Object(n.a)(Me,2),He=Re[0],Ke=Re[1],Ue=i.a.useState(0),We=Object(n.a)(Ue,2),Xe=We[0],Ye=We[1],Ze=i.a.useState(0),$e=Object(n.a)(Ze,2),et=$e[0],tt=$e[1],ct=i.a.useState(""),at=Object(n.a)(ct,2),st=at[0],nt=at[1],rt=0,lt=0,ot=0,it=0,ut=0,dt=0,jt=0;function bt(){return pt.apply(this,arguments)}function pt(){return(pt=Object(s.a)(l.a.mark((function e(){var a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(j.c+"fetchQuotationProducts",{method:"GET",headers:{Authorization:null===t||void 0===t?void 0:t.token}});case 2:if(!0!==(a=e.sent).ok){e.next=9;break}return e.next=6,a.json();case 6:s=e.sent,c(!1),200===s.status?(f(s.quotation_number),N(s.default_gst),Ae(s.product_list.map((function(e){return"product"===e.type?{value:e.id,label:e.name,type:e.type,unit:e.unit,hsbn:e.hsbn,serial_no:e.serial_no,price:parseFloat(parseFloat(e.price)/parseFloat(e.sales_unit)).toFixed(2)}:{value:e.id,label:e.name,type:e.type,unit:e.unit,hsbn:e.hsbn,serial_no:e.serial_no,price:e.price}})))):p.b.error(s.message);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}i.a.useEffect((function(){function e(){return(e=Object(s.a)(l.a.mark((function e(){var a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,fetch(j.c+"clientlist",{method:"GET",headers:{Authorization:null===t||void 0===t?void 0:t.token}});case 3:if(!0!==(a=e.sent).ok){e.next=10;break}return e.next=7,a.json();case 7:s=e.sent,c(!1),200===s.status?ke(null===s||void 0===s?void 0:s.client_list.map((function(e){return{value:e.id,label:e.name,amount:e.due_amount}}))):p.b.error(s.message);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function a(){return(a=Object(s.a)(l.a.mark((function e(){var a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,fetch(j.c+"getGSTList",{method:"GET",headers:{Authorization:null===t||void 0===t?void 0:t.token}});case 3:return a=e.sent,e.next=6,a.json();case 6:s=e.sent,c(!1),he(null===s||void 0===s?void 0:s.gst.map((function(e){return{value:e,label:e}})));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){a.apply(this,arguments)}(),bt()}),[]);ce>0&&ue>0&&(ot=parseFloat(ce)*parseFloat(ue),lt=0,C&&re&&(lt=parseFloat(ot)/100*parseFloat(re.value)),rt=dt=ot+lt,"Item"!==T&&"Both"!==T||(it=dt,"percent"===V&&(jt=parseFloat(it)/100*parseFloat(I),rt=ut=it-jt),"amount"===V&&(jt=parseFloat(I),rt=ut=it-jt)));He>0&&("Bill"===T||"Both"===T?("percent"===Z&&(Pe=He/100*parseFloat(U),He,Be=He-Pe),"amount"===Z&&(Pe=parseFloat(U),He,Be=He-Pe),De=(Te=Be)-parseFloat(Qe)):De=(Te=He)-parseFloat(Qe));return Object(h.jsxs)("div",{className:"container full-size-create-page-main-section",children:[Object(h.jsx)(p.a,{}),Object(h.jsxs)("form",{children:[Object(h.jsxs)("div",{className:"p-sm-5 px-md-3 create-form-field create-purchase-page",children:[Object(h.jsxs)("div",{class:"py-4 px-2 form-row create-purchase-header",children:[Object(h.jsxs)("div",{class:"form-group col-md-3",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Quotation No.",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{readOnly:!0,value:m,type:"text",class:"form-control",id:"invoice-number",required:!0})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsx)("label",{for:"date",children:"Quotation Date"}),Object(h.jsx)("input",{value:v,onChange:function(e){return g(e.target.value)},type:"date",class:"form-control",id:"date"})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"input-party",children:["Customer",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)(d.a,{options:ye,value:F,onChange:_})]}),Object(h.jsxs)("div",{class:"form-group my-md-3 col-md-4",children:[Object(h.jsx)("div",{className:"text-center mb-2 font-weight-bold",children:Object(h.jsxs)("label",{for:"input-party",children:["Discount Type",Object(h.jsx)("span",{className:"required-label",children:"*"})]})}),Object(h.jsxs)("div",{className:"row px-3",children:[Object(h.jsxs)("div",{class:"form-check col-sm-3",children:[Object(h.jsx)("input",{checked:"None"===T&&!0,onClick:function(){return D("None")},class:"form-check-input",name:"discount",type:"radio",value:"",id:"defaultCheck1"}),Object(h.jsx)("label",{class:"form-check-label",for:"defaultCheck1",children:"None"})]}),Object(h.jsxs)("div",{class:"form-check col-sm-3",children:[Object(h.jsx)("input",{onClick:function(){return D("Item")},class:"form-check-input",name:"discount",type:"radio",value:"",id:"defaultCheck2"}),Object(h.jsx)("label",{class:"form-check-label",for:"defaultCheck2",children:"Item"})]}),Object(h.jsxs)("div",{class:"form-check col-sm-3",children:[Object(h.jsx)("input",{onClick:function(){return D("Bill")},class:"form-check-input",name:"discount",type:"radio",value:"",id:"defaultCheck3"}),Object(h.jsx)("label",{class:"form-check-label",for:"defaultCheck3",children:"Bill"})]}),Object(h.jsxs)("div",{class:"form-check col-sm-3",children:[Object(h.jsx)("input",{onClick:function(){return D("Both")},class:"form-check-input",name:"discount",type:"radio",value:"",id:"defaultCheck3"}),Object(h.jsx)("label",{class:"form-check-label",for:"defaultCheck3",children:"Both"})]})]})]}),Object(h.jsxs)("div",{class:"form-group col-md-2",children:[Object(h.jsx)("label",{for:"inputPassword",class:"col-sm-2 col-form-label",children:"GST:"}),Object(h.jsx)("div",{class:"d-flex b-0 col-sm-1",children:Object(h.jsx)("input",{checked:C,type:"checkbox",onChange:function(e){return function(){var e=!C;function a(){return(a=Object(s.a)(l.a.mark((function a(){var s,n;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c(!0),a.next=3,fetch(j.c+"fetchQuotationNo?default_gst=".concat(e),{headers:{Authorization:t.token}});case 3:if(!0!==(s=a.sent).ok){a.next=10;break}return a.next=7,s.json();case 7:n=a.sent,c(!1),200==n.status?f(n.quotation_number):p.b.error(n.message);case 10:case"end":return a.stop()}}),a)})))).apply(this,arguments)}N(!C),function(){a.apply(this,arguments)}()}()}})})]})]}),Object(h.jsxs)("div",{class:"my-4 form-row",children:[Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Item",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)(d.a,{options:qe,value:M,onChange:R})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Price",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{value:ce,onChange:function(e){return ae(e.target.value)},type:"text",class:"form-control",id:"",required:!0})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Quantity",M?" (".concat(M.unit,")"):null,Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{value:ue,onChange:function(e){return de(e.target.value)},type:"text",class:"form-control",id:"",required:!0})]}),C&&Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["GST:",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)(d.a,{options:pe,value:re,onChange:le})]}),"Item"===T&&Object(h.jsxs)("div",{className:"form-group col-md-4",children:[Object(h.jsx)("label",{htmlFor:"",children:"Discount"}),Object(h.jsxs)("div",{className:"m-0 p-0 col-12 row",children:[Object(h.jsx)("div",{className:"px-0 col-5",children:Object(h.jsx)("input",{value:I,onChange:function(e){return G(e.target.value)},class:"form-control",type:"text",name:"",id:""})}),Object(h.jsx)("div",{className:"p-0 col-7",children:Object(h.jsxs)("select",{value:V,onChange:function(e){return E(e.target.value)},class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select Type"}),Object(h.jsx)("option",{value:"percent",children:"Percent"}),Object(h.jsx)("option",{value:"amount",children:"Amount"})]})})]})]}),"Both"===T&&Object(h.jsxs)("div",{className:"form-group col-md-4",children:[Object(h.jsx)("label",{htmlFor:"",children:"Discount"}),Object(h.jsxs)("div",{className:"m-0 p-0 col-12 row",children:[Object(h.jsx)("div",{className:"px-0 col-5",children:Object(h.jsx)("input",{value:I,onChange:function(e){return G(e.target.value)},class:"form-control",type:"text",name:"",id:""})}),Object(h.jsx)("div",{className:"p-0 col-7",children:Object(h.jsxs)("select",{value:V,onChange:function(e){return E(e.target.value)},class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select Type"}),Object(h.jsx)("option",{value:"percent",children:"Percent"}),Object(h.jsx)("option",{value:"amount",children:"Amount"})]})})]})]}),Object(h.jsxs)("div",{class:"form-group col-md-4 row",children:[Object(h.jsxs)("div",{class:"form-group col-9",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Total",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{value:rt,readOnly:!0,type:"text",class:"form-control",id:""})]}),Object(h.jsx)("div",{class:"form-group col-3 p-0 purchase-create-mid-plus-img",children:Object(h.jsx)("img",{className:"img-fluid",onClick:function(){return function(){if(m&&M&&F&&ce&&ue){var e={item:M,price:ce,qty:ue,gst:re,discount_type:V,discountValue:I,total:rt,amount_item:ot,amount_before_discount:it,discount_amount:jt,tax_amount:lt,amount_after_discount:ut};if(st){nt("");var t=[];we.map((function(c,a){a===parseInt(st)-1?t.push(e):t.push(c)}));var c=0,s=0,n=0;t.map((function(e){c=parseFloat(c)+parseFloat(e.total),s=parseFloat(s)+parseFloat(e.discount_amount),n=parseFloat(n)+parseFloat(e.tax_amount)})),Ke(c),Ye(s),tt(n),Se(t)}else{var r=[].concat(Object(a.a)(we),[e]),l=0,o=0;r.map((function(e){l=parseFloat(l)+parseFloat(e.total),jt=parseFloat(jt)+parseFloat(e.discount_amount),o=parseFloat(o)+parseFloat(e.tax_amount)})),Ye(jt),tt(o),Ke(l),Ke(parseFloat(He)+parseFloat(rt)),Se(r)}R(""),ae(0),E(""),G(0),de(1),le({value:0,label:0}),rt=0,ot=0,it=0,ut=0,jt=0,lt=0,dt=0}else p.b.error("Fill all fields having *")}()},style:{cursor:"pointer"},src:u.a,alt:""})})]})]}),we.length>0&&Object(h.jsx)("div",{className:"my-table-responsive",children:Object(h.jsxs)("table",{class:"table mt-4",children:[Object(h.jsx)("thead",{class:"thead-dark",children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{scope:"col",children:"Item"}),Object(h.jsx)("th",{scope:"col",children:"Price"}),Object(h.jsx)("th",{scope:"col",children:"Quantity"}),Object(h.jsx)("th",{scope:"col",children:"GST"}),Object(h.jsx)("th",{scope:"col",children:"Discount"}),Object(h.jsx)("th",{scope:"col",children:"Total"}),Object(h.jsx)("th",{children:"Actions"})]})}),Object(h.jsx)("tbody",{className:"table-borderless",children:we.map((function(e,t){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e.item.label}),Object(h.jsx)("td",{children:e.price}),Object(h.jsx)("td",{children:e.qty}),Object(h.jsxs)("td",{children:[e.gst.value,"%"]}),Object(h.jsxs)("td",{children:[e.discountValue," ",e.discount_type]}),Object(h.jsx)("td",{children:e.total}),Object(h.jsxs)("td",{children:[Object(h.jsx)("i",{style:{cursor:"pointer"},onClick:function(){return function(e,t){nt(t),R(e.item),ae(e.price),de(e.qty),le(e.gst),E(e.discount_type),G(e.discountValue),rt=e.total}(e,t+1)},class:"fa fa-pencil","aria-hidden":"true"}),Object(h.jsx)("i",{onClick:function(){return function(e){var t=[];we.map((function(c,a){a!==e&&t.push(c)})),Se(t)}(t)},style:{cursor:"pointer"},class:"fa fa-trash","aria-hidden":"true"})]})]})}))})]})}),Object(h.jsxs)("div",{className:"row mt-5 justify-content-between purchase-create-footer",children:[Object(h.jsxs)("div",{class:"form-group col-md-5",children:[Object(h.jsx)("label",{for:"exampleFormControlTextarea1",children:"Remarks"}),Object(h.jsx)("textarea",{value:xe,onChange:function(e){return Oe(e.target.value)},class:"form-control",id:"exampleFormControlTextarea1",rows:"5"}),F?Object(h.jsxs)("div",{children:["Due Amount: ",F.amount]}):null]}),Object(h.jsxs)("div",{className:"col-md-6",children:[Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Total Value"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{type:"text",value:He,class:"form-control",id:""})})]}),"Bill"===T&&Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Discount"}),Object(h.jsxs)("div",{class:"pr-0 col-md-8 row",children:[Object(h.jsx)("div",{className:"pr-0 col-5",children:Object(h.jsx)("input",{class:"form-control",value:U,onChange:function(e){return W(e.target.value)},type:"text",name:"",id:""})}),Object(h.jsx)("div",{className:"px-0 col-7",children:Object(h.jsxs)("select",{value:Z,onChange:function(e){return $(e.target.value)},class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select Type"}),Object(h.jsx)("option",{value:"percent",children:"Percent"}),Object(h.jsx)("option",{value:"amount",children:"Amount"})]})})]})]}),"Both"===T&&Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Discount"}),Object(h.jsxs)("div",{class:"pr-0 col-md-8 row",children:[Object(h.jsx)("div",{className:"pr-0 col-5",children:Object(h.jsx)("input",{class:"form-control",type:"text",value:U,onChange:function(e){return W(e.target.value)}})}),Object(h.jsx)("div",{className:"px-0 col-7",children:Object(h.jsxs)("select",{value:Z,onChange:function(e){return $(e.target.value)},class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select Type"}),Object(h.jsx)("option",{value:"percent",children:"Percent"}),Object(h.jsx)("option",{value:"amount",children:"Amount"})]})})]})]}),Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Final Amount"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{readOnly:!0,value:Te,type:"text",class:"form-control",id:""})})]}),Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Paid Amount"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{value:Qe,onChange:function(e){return ze(e.target.value)},type:"text",class:"form-control",id:""})})]}),Qe>0&&Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Payment Method"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsxs)("select",{value:Je,onChange:function(e){return Le(e.target.value)},id:"input-party",class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select payment mode"}),Object(h.jsx)("option",{value:"cash",children:"Cash"}),Object(h.jsx)("option",{value:"bank",children:"Bank"})]})})]}),Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Remain Amount"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{type:"text",value:De,readOnly:!0,class:"form-control",id:""})})]})]})]})]}),Object(h.jsxs)("div",{class:"d-flex justify-content-center create-catagory-btns",children:[Object(h.jsxs)("button",{type:"button",onClick:function(){return window.location.reload()},class:"font-weight-bold m-3 py-2 px-4 btn btn-danger",children:["Cancel",Object(h.jsx)("i",{class:"px-2 fa fa-times","aria-hidden":"true"})]}),Object(h.jsxs)("button",{type:"button",onClick:function(){return function(){if(m&&F&&we.length>0&&He){var e=function(){var e=Object(s.a)(l.a.mark((function e(){var a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(j.c+"createQuotation",{method:"POST",headers:{Authorization:t.token},body:o});case 2:if(!0!==(a=e.sent).ok){e.next=9;break}return e.next=6,a.json();case 6:s=e.sent,c(!1),200===s.status?(p.b.success(s.message),g(""),_(""),D("None"),Ye(0),N(!1),tt(0),$("percent"),W(0),R(""),Ke(0),ze(0),Se(""),Le("cash"),Te=0,De=0,Pe=0,0,Be=0,bt()):p.b.error(s.message);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();c(!0);var a={quotationNo:m,quotationDate:v,default_gst:C,currentCustomer:F,discountType:T},n={totalValue:He,finalAmount:Te,paidAmount:Qe,remainAmount:De,finalDiscountValue:U,finalDiscountCriteria:Z,remarks:xe,paymentMethod:Je,discountAmount:Xe,taxableAmount:et},r=[];r.push(a),r.push(n);var o=new FormData;o.append("final_array",JSON.stringify(r)),o.append("allItems",JSON.stringify(we)),e()}else p.b.error("Please fill the data with *")}()},class:"font-weight-bold m-3 py-2 px-4 btn btn-success",children:["Save",Object(h.jsx)("i",{class:"px-2 fa fa-floppy-o","aria-hidden":"true"})]})]})]})]})}}}]);
//# sourceMappingURL=65.4ffd0a04.chunk.js.map