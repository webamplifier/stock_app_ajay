{"version":3,"sources":["assets/images_manual/add.svg","screens/Sales/Sales Return/edit.js"],"names":["Edit","id","useParams","history","useHistory","React","useContext","userContext","user","setLoad","useState","invoiceNo","setInvoiceNo","saleReturnDate","setSaleReturnDate","default_gst","setDefaultGST","currentCustomer","setCurrentCustomer","currentWarehouse","setCurrentWarehouse","discountType","setDiscountType","discountValue","setDiscountValue","label","currentPaymentMethod","setCurrentPaymentMethod","currentDiscountCriteria","setCurrentDiscountCriteria","currentProduct","setCurrentProduct","finalDiscountValue","setFinalDiscountValue","finalDiscountCriteria","setFinalDiscountCriteria","sale_return_price","setSaleReturnPrice","value","gst","setGST","qty","setQty","gst_list","setGSTList","remarks","setRemarks","allCustomers","setAllCustomers","allPaymentMethods","setAllPaymentMethods","allWarehouses","setAllWarehouses","allItems","setAllItems","allProducts","setAllProducts","finalAmount","remainAmount","discount_amount_final","amount_after_discount_final","paidAmount","setPaidAmount","totalValue","setTotalValue","discountAmount","setDiscountAmount","taxAmount","setTaxableAmount","currentEditItem","setCurrentEditItem","perItemAmount","tax_amount","amount_item","amount_before_discount","amount_after_discount","amount_after_tax","discount_amount","fetchProd","e","a","fetch","url","method","headers","token","response","ok","json","data","status","products","inventory_list","map","item","push","product_id","product_name","type","unit","product_unit","price","sale_unit_price","hsbn","product_hsbn","serial_no","product_serial_no","product_list","name","toast","error","message","useEffect","payment_methods","console","log","client_list","amount","due_amount","warehouse_list","header","sale_return_header","final_discount_criteria","final_discount_value","parseFloat","bill_discount_percentage","bill_discount_amount","items","sale_return_items","invoice_number","sale_return_date","customer_id","customer_name","warehouse_id","warehouse_name","discount_type","midItems","i","length","current_item","discount_value","discount_percent","obj","product_type","item_id","tax_percent","total","current_total_fetch","taxable_amount","amount_paid","fetchPaymentMethods","fetchDataParty","fetchGSTList","fetchWarehouse","fetchDetailSales","className","class","for","readOnly","required","options","onChange","target","checked","onClick","handleProduct","htmlFor","new_item_dict","new_list_edit","index","parseInt","new_item_list","handleSubmitItem","style","cursor","src","plus","alt","scope","index_value","handleEdit","new_item","handleDelete","rows","window","location","reload","submitSales","body","formData","success","final","paymentMethod","taxableAmount","final_array","FormData","append","JSON","stringify","finalSubmit"],"mappings":"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","file":"static/js/70.de92761f.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/add.b7874215.svg\";","import React from 'react'\nimport plus from '../../../assets/images_manual/add.svg'\nimport Select from 'react-select';\nimport { url, formatDate } from 'src/helpers/helpers';\nimport { userContext } from '../../../context/UserContext'\nimport { toast, ToastContainer } from 'react-toastify';\nimport { useHistory, useParams } from 'react-router-dom'\n\nexport default function Edit() {\n    let { id } = useParams();\n    const history = useHistory();\n    const { user,setLoad } = React.useContext(userContext);\n    const [invoiceNo, setInvoiceNo] = React.useState('');\n    const [saleReturnDate, setSaleReturnDate] = React.useState('');\n    const [default_gst, setDefaultGST]  = React.useState(false);\n    const [currentCustomer, setCurrentCustomer] = React.useState('');\n    const [currentWarehouse, setCurrentWarehouse] = React.useState('');\n    const [discountType, setDiscountType] = React.useState('None');\n    const [discountValue, setDiscountValue] = React.useState(0);\n    const [currentPaymentMethod, setCurrentPaymentMethod] = React.useState({\n        label: \"cash\"\n    })\n    const [currentDiscountCriteria, setCurrentDiscountCriteria] = React.useState('percent');\n    const [currentProduct, setCurrentProduct] = React.useState('');\n    const [finalDiscountValue, setFinalDiscountValue] = React.useState(0);\n    const [finalDiscountCriteria, setFinalDiscountCriteria] = React.useState('percent');\n    const [sale_return_price, setSaleReturnPrice] = React.useState(0);\n    const [gst,setGST] = React.useState({\n        value:0,\n        label:0\n    });\n    const [qty, setQty] = React.useState(1);\n    const [gst_list,setGSTList] = React.useState([]);\n    const [remarks, setRemarks] = React.useState('');\n\n    const [allCustomers, setAllCustomers] = React.useState([]);\n    const [allPaymentMethods, setAllPaymentMethods] = React.useState([]);\n    const [allWarehouses, setAllWarehouses] = React.useState([]);\n    const [allItems, setAllItems] = React.useState([]);\n    const [allProducts,setAllProducts] = React.useState([]);\n\n    //final related variables and states\n    let finalAmount = 0;\n    let remainAmount = 0;\n    let discount_amount_final = 0;\n    let amount_before_discount_final = 0;\n    let amount_after_discount_final = 0;\n\n    const [paidAmount, setPaidAmount] = React.useState(0);\n    const [totalValue, setTotalValue] = React.useState(0);\n    const [discountAmount,setDiscountAmount] = React.useState(0);\n    const [taxAmount,setTaxableAmount] = React.useState(0);\n\n    //edit related states\n    const [currentEditItem, setCurrentEditItem] = React.useState('');\n\n    //item based variables\n    let perItemAmount = 0;\n    let tax_amount = 0;\n    let amount_item = 0;\n    let amount_before_discount = 0;\n    let amount_after_discount = 0;\n    let amount_after_tax=0;\n    let discount_amount = 0;\n\n    React.useEffect(() => {\n        \n        async function fetchPaymentMethods() {\n            setLoad(true);\n            const response = await fetch(url + 'getPaymentMethods', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n            const data = await response.json();\n            setLoad(false);\n            setAllPaymentMethods(data?.payment_methods.map(item => {\n                return {\n                    label: item\n                }\n            }))\n        }\n        fetchPaymentMethods();\n\n        async function fetchDataParty() {\n            setLoad(true);\n            const response = await fetch(url + 'clientlist', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    console.log(data);\n                    setAllCustomers(data?.client_list.map(item => {\n                        return {\n                            value: item.id,\n                            label: item.name,\n                            amount: item.due_amount,\n                        }\n                    }))\n                } else {\n                    toast.error(data.message)\n                }\n            }\n        }\n        fetchDataParty();\n\n        async function fetchGSTList() {\n            setLoad(true);\n            const response = await fetch(url + 'getGSTList', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n            const data = await response.json();\n            setLoad(false);\n            setGSTList(data?.gst.map(item => {\n                return {\n                    value: item,\n                    label: item\n                }\n            }))\n        }\n        fetchGSTList();\n\n        async function fetchWarehouse() {\n            setLoad(true);\n            const response = await fetch(url + 'warehouselist', {\n                method: 'GET',\n                headers: {\n                    'Authorization': user?.token\n                }\n            })\n\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    setAllWarehouses(data?.warehouse_list.map(item => {\n                        return {\n                            value: item.id,\n                            label: item.name\n                        }\n                    }))\n                } else {\n                    toast.error(data.message)\n                }\n            }\n        }\n        fetchWarehouse();\n\n        async function fetchDetailSales() {\n            setLoad(true);\n            const response = await fetch(url + 'getSaleReturnById/' + id, {\n                headers: {\n                    'Authorization': user.token\n                }\n            });\n\n            if (response.ok === true) {\n                const data = await response.json();\n                setLoad(false)\n                if (data.status === 200) {\n                    let header = data.sale_return_header;\n                    let final_discount_criteria='';\n                    let final_discount_value = 0;\n                    if (parseFloat(header.bill_discount_percentage)>0) {\n                        final_discount_criteria = 'percent';\n                        final_discount_value = header.bill_discount_percentage;\n                    } else if (parseFloat(header.bill_discount_amount)>0) {\n                        final_discount_criteria = 'amount';\n                        final_discount_value = header.bill_discount_amount\n                    }\n                    let items = data.sale_return_items;\n                    setInvoiceNo(header.invoice_number);\n                    setSaleReturnDate(header.sale_return_date);\n                    setCurrentCustomer({\n                        value: header.customer_id,\n                        label: header.customer_name\n                    });\n                    setCurrentWarehouse({\n                        value: header.warehouse_id,\n                        label: header.warehouse_name\n                    })\n                    fetchProd(header.warehouse_id);\n                    setDiscountType(header.discount_type);\n                    let midItems = [];\n                    for (let i = 0; i < items.length; i++) {\n                        let current_item = items[i]; \n                        let discount_type = '';\n                        let discount_value = 0;\n                        \n                        if (current_item.discount_percent && parseFloat(current_item.discount_percent) > 0) {\n                            discount_type = 'percent'\n                            discount_value = current_item.discount_percent\n                        } else if (current_item.discount_amount) {\n                            discount_type = 'amount';\n                            discount_value = current_item.discount_amount\n                        } else {\n                            //\n                        }\n                        let obj={};\n                        if(header.default_gst===\"true\"){\n                            setDefaultGST(true);\n                            obj = {\n                            item: {\n                                value: current_item.product_id,\n                                label: current_item.product_name,\n                                type: current_item.product_type,\n                                unit: current_item.product_unit,\n                                price: current_item.sale_return_price,\n                                hsbn: current_item.product_hsbn,\n                                serial_no: current_item.product_serial_no\n                            },\n                            item_id: current_item.id,\n                            sale_return_price: current_item.sale_return_price,\n                            qty: current_item.qty,\n                            discount_type: discount_type,\n                            discountValue: discount_value,\n                            gst: {\n                                label: current_item.tax_percent,\n                                value: current_item.tax_percent\n                            },\n                            total: current_item.total,\n                            amount_item: current_item.total,\n                            amount_after_tax: current_item.amount_after_tax,\n                            amount_before_discount: current_item.amount_before_discount,\n                            tax_amount: current_item.tax_amount,\n                            discount_amount: current_item.discount_amount,\n                            amount_after_discount: current_item.amount_after_discount,\n                            warehouse_id : current_item.warehouse_id,\n                            warehouse_name : current_item.warehouse_name\n                        }\n                    }\n                    else{\n                        setDefaultGST(false);\n                        obj = {\n                            item: {\n                                value: current_item.product_id,\n                                label: current_item.product_name,\n                                type: current_item.product_type,\n                                unit: current_item.product_unit,\n                                hsbn: current_item.product_hsbn,\n                                price: current_item.sale_return_price,\n                                serial_no: current_item.product_serial_no\n                            },\n                            item_id: current_item.id,\n                            sale_return_price: current_item.sale_return_price,\n                            qty: current_item.qty,\n                            discount_type: discount_type,\n                            discountValue: discount_value,\n                            gst: {\n                                value:0,\n                                label:0\n                            },\n                            total: current_item.total,\n                            amount_item: current_item.total,\n                            amount_after_tax: current_item.amount_after_tax,\n                            amount_before_discount: current_item.amount_before_discount,\n                            tax_amount: current_item.tax_amount,\n                            discount_amount: current_item.discount_amount,\n                            amount_after_discount: current_item.amount_after_discount,\n                            warehouse_id : current_item.warehouse_id,\n                            warehouse_name : current_item.warehouse_name\n                        }\n                    }\n                        midItems.push(obj)\n                    }\n                    setAllItems(midItems);\n                    let current_total_fetch = 0;\n                    let discount_amount = 0;\n                    let taxable_amount = 0;\n                    midItems.map(item => {\n                        current_total_fetch = parseFloat(current_total_fetch) + parseFloat(item.total)\n                        discount_amount = parseFloat(discount_amount) + parseFloat(item.discount_amount)\n                        taxable_amount = parseFloat(taxable_amount)+ parseFloat(item.tax_amount);\n                    })\n                    setTotalValue(current_total_fetch);\n                    setDiscountAmount(discount_amount);\n                    setTaxableAmount(taxable_amount);\n                    setFinalDiscountValue(final_discount_value);\n                    setFinalDiscountCriteria(final_discount_criteria);\n                    setPaidAmount(header.amount_paid);\n                    setCurrentPaymentMethod({\n                        label: \"cash\"\n                    });\n                    setRemarks(header.remarks);\n                } else {\n                    toast.error(data.message);\n                }\n            }\n        }\n        fetchDetailSales()\n    }, [])\n\n    async function fetchProd(e) {\n        setLoad(true);    \n        const response = await fetch(url + `fetchProducts?warehouse=${e}`, {\n            method: 'GET',\n            headers: {\n                'Authorization': user?.token\n            }\n        })\n        if (response.ok === true) {\n            const data = await response.json();\n            setLoad(false)\n            if (data.status === 200) {\n                let products=[];\n                if(data.inventory_list){\n                  data.inventory_list.map(item=>{\n                    products.push(\n                       {value : item.product_id,\n                        label : item.product_name,\n                        type : \"product\",\n                        unit : item.product_unit,\n                        price: item.sale_unit_price,\n                        hsbn : item.product_hsbn,\n                        serial_no : item.product_serial_no,\n                       }\n                  )})\n                }\n                if(data.product_list){\n                    data.product_list.map(item=>{\n                      products.push(\n                         {value : item.id,   \n                          label : item.name,\n                          type: item.type,\n                          unit: item.unit,\n                          price: item.price,\n                          hsbn : item.hsbn,\n                          serial_no : item.serial_no\n                         }\n                    )})\n                  }  \n                setAllProducts(products);\n            } else {\n                toast.error(data.message)\n            }\n        }\n    }\n\n    const calculateTotal = () => {\n        if (sale_return_price > 0 && qty > 0) {\n            amount_item = parseFloat(sale_return_price) * parseFloat(qty); //amount before tax\n            tax_amount=0;\n            if(default_gst && gst){\n            tax_amount = (parseFloat(amount_item)/100) * parseFloat(gst.value);\n            }\n            amount_after_tax = amount_item + tax_amount;\n            perItemAmount = amount_after_tax;\n\n            if (discountType === 'Item' || discountType === 'Both') {\n                amount_before_discount = amount_after_tax;\n                if (currentDiscountCriteria === 'percent') {\n                    discount_amount = (parseFloat(amount_before_discount) / 100) * parseFloat(discountValue)\n                    amount_after_discount = amount_before_discount - discount_amount;\n                    perItemAmount = amount_after_discount;\n                }\n\n                if (currentDiscountCriteria === 'amount') {\n                    discount_amount = parseFloat(discountValue);\n                    amount_after_discount = amount_before_discount - discount_amount;\n                    perItemAmount = amount_after_discount;\n                }\n            }\n        }\n    }\n\n    calculateTotal()\n\n    const calculateFinalPrice = () => {\n        if (totalValue > 0) {\n            if (discountType === 'Bill' || discountType === 'Both') {\n                if (finalDiscountCriteria === 'percent') {\n                    discount_amount_final = totalValue / 100 * parseFloat(finalDiscountValue);\n                    amount_before_discount_final = totalValue;\n                    amount_after_discount_final = totalValue - discount_amount_final;\n                }\n\n                if (finalDiscountCriteria === 'amount') {\n                    discount_amount_final = parseFloat(finalDiscountValue);\n                    amount_before_discount_final = totalValue;\n                    amount_after_discount_final = totalValue - discount_amount_final;\n                }\n                finalAmount = amount_after_discount_final;\n                remainAmount = finalAmount - parseFloat(paidAmount);\n            } else {\n                finalAmount = totalValue\n                remainAmount = finalAmount - parseFloat(paidAmount);\n            }\n        }\n    }\n\n    calculateFinalPrice()\n\n    const handleSubmitItem = () => {\n        if (invoiceNo && saleReturnDate && currentProduct && currentWarehouse && currentCustomer && sale_return_price && qty) {\n            let new_item_dict = {\n                item: currentProduct,\n                sale_return_price: sale_return_price,\n                qty: qty,\n                gst: gst,\n                discount_type: currentDiscountCriteria,\n                discountValue,\n                total: perItemAmount,\n                amount_item,\n                amount_before_discount,\n                discount_amount,\n                tax_amount,\n                amount_after_discount,\n                warehouse_id : currentWarehouse.value,\n                warehouse_name : currentWarehouse.label\n            };\n            if (currentEditItem) {\n                setCurrentEditItem('')\n                let new_list_edit = []\n                allItems.map((item, index) => {\n                    if (index === parseInt(currentEditItem)-1) {\n                        new_list_edit.push(new_item_dict)\n                    } else {\n                        new_list_edit.push(item)\n                    }\n                })\n                let total = 0;\n                let discount_amount=0;\n                let taxable_amount=0;\n                new_list_edit.map(item=>{\n                    total = parseFloat(total) + parseFloat(item.total);\n                    discount_amount = parseFloat(discount_amount) + parseFloat(item.discount_amount);\n                    taxable_amount = parseFloat(taxable_amount) + parseFloat(item.tax_amount);\n                })\n                setTotalValue(total);\n                setDiscountAmount(discount_amount);\n                setTaxableAmount(taxable_amount);\n                setAllItems(new_list_edit);\n            } else {\n                let new_item_list = [...allItems, new_item_dict];\n                let total = 0;\n                let taxable_amount=0;\n                new_item_list.map(item=>{\n                    total = parseFloat(total) + parseFloat(item.total);\n                    discount_amount = parseFloat(discount_amount) + parseFloat(item.discount_amount);\n                    taxable_amount = parseFloat(taxable_amount) + parseFloat(item.tax_amount);\n                })\n                setDiscountAmount(discount_amount);\n                setTaxableAmount(taxable_amount);\n                setTotalValue(total);\n\n                setTotalValue(parseFloat(totalValue) + parseFloat(perItemAmount))\n                setAllItems(new_item_list);\n            }\n            setCurrentProduct('');\n            setSaleReturnPrice(0);\n            setCurrentDiscountCriteria('');\n            setDiscountValue(0);\n            setQty(1);\n            setGST({\n                label:0,\n                value:0\n            });\n            perItemAmount = 0;\n            amount_item= 0;\n            amount_before_discount = 0;\n            amount_after_discount = 0;\n            discount_amount = 0;\n            tax_amount=0;\n            amount_after_tax=0;\n        } else {\n            toast.error('Fill all fields having *')\n        }\n    }\n\n    const finalSubmit = () => {\n        if (invoiceNo && saleReturnDate && currentWarehouse && currentCustomer && allItems.length > 0 && totalValue){\n            setLoad(true)\n            let header = {\n                invoiceNo : invoiceNo,\n                saleReturnDate : saleReturnDate,\n                currentCustomer : currentCustomer,\n                currentWarehouse : currentWarehouse,\n                discountType : discountType,\n                default_gst: default_gst\n            }\n            let final = {\n                totalValue : totalValue,\n                finalAmount : finalAmount,\n                paidAmount : paidAmount,\n                remainAmount : remainAmount,\n                finalDiscountValue : finalDiscountValue,\n                finalDiscountCriteria : finalDiscountCriteria,\n                remarks : remarks,\n                paymentMethod : currentPaymentMethod.label,\n                discountAmount : discountAmount,\n                taxableAmount : taxAmount\n            }\n\n            let final_array = [];\n\n            final_array.push(header);\n            final_array.push(final);\n\n            const formData = new FormData();\n            formData.append('final_array',JSON.stringify(final_array));\n            formData.append('allItems',JSON.stringify(allItems));\n\n            async function submitSales(){\n                const response = await fetch(url + 'updateSaleReturn/' + id,{\n                    method : 'POST',\n                    headers : {\n                        'Authorization' : user.token\n                    },\n                    body : formData\n                });\n                if (response.ok === true){\n                    const data = await response.json();\n                    setLoad(false)\n                    if (data.status === 200){\n                        toast.success(data.message);\n                        history.push('/salesReturnReport')\n                    }else{\n                        toast.error(data.message);\n                    }\n                }\n            }\n            submitSales()\n        }else{\n            toast.error('Please fill the data with *');\n        }\n    }\n\n    const handleEdit = (item, index_value) => {\n        setCurrentEditItem(index_value);\n        setCurrentProduct(item.item);\n        setSaleReturnPrice(item.sale_return_price);\n        setQty(item.qty);\n        setGST(item.gst);\n        setCurrentDiscountCriteria(item.discount_type);\n        setDiscountValue(item.discountValue);\n        perItemAmount = item.total;\n    }\n\n    const handleDelete = (index_value) => {\n        const new_item = [];\n        allItems.map((item, index) => {\n            if (index !== index_value) {\n                new_item.push(item)\n            }\n        })\n        let total = 0;\n        let discount_amount = 0;\n        let taxable_amount = 0;\n        new_item.map(item => {\n            total = parseFloat(total) + parseFloat(item.total);\n            discount_amount = parseFloat(discount_amount) + parseFloat(item.discount_amount)\n            taxable_amount = parseFloat(taxable_amount) + parseFloat(item.tax_amount)\n        })\n        setDiscountAmount(discount_amount);\n        setTaxableAmount(taxable_amount);\n        setTotalValue(total);\n        setAllItems(new_item);\n    }\n    const handleProduct=(e)=>{\n        setCurrentProduct(e);\n        setSaleReturnPrice(e.price);\n    }\n\n    return (\n        <div className=\"container full-size-create-page-main-section\">\n            <ToastContainer />\n            <form>\n                <div className='p-sm-5 px-md-3 create-form-field create-purchase-page'>\n                    <div class=\"py-4 px-2 form-row create-purchase-header\">\n                        <div class=\"form-group col-md-3\">\n                            <label for=\"invoice-number\">Invoice No.<span className='required-label'>*</span></label>\n                            <input readOnly value={invoiceNo} type=\"text\" class=\"form-control\" id=\"invoice-number\" required />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"input-party\">Warehouse<span className='required-label'>*</span></label>\n                            <Select readOnly options={allWarehouses} value={currentWarehouse} />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"date\">Sale Return Date</label>\n                            <input value={saleReturnDate} onChange={e => setSaleReturnDate(e.target.value)} type=\"date\" class=\"form-control\" id=\"date\" />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"input-party\">Customer<span className='required-label'>*</span></label>\n                            <Select options={allCustomers} value={currentCustomer} />\n                        </div>\n                        <div class=\"form-group my-md-3 col-md-4\">\n                            <div className=\"text-center mb-2 font-weight-bold\">\n                                <label for=\"input-party\">Discount Type<span className='required-label'>*</span></label>\n                            </div>\n                            <div className='row px-3'>\n                                <div class=\"form-check col-sm-3\">\n                                    <input checked={discountType === 'None' && true} onClick={() => setDiscountType('None')} class=\"form-check-input\" name=\"discount\" type=\"radio\" value=\"\" id=\"defaultCheck1\" />\n                                    <label class=\"form-check-label\" for=\"defaultCheck1\">\n                                        None\n                                    </label>\n                                </div>\n                                <div class=\"form-check col-sm-3\">\n                                    <input checked={discountType === 'Item' && true} onClick={() => setDiscountType('Item')} class=\"form-check-input\" name=\"discount\" type=\"radio\" value=\"\" id=\"defaultCheck2\" />\n                                    <label class=\"form-check-label\" for=\"defaultCheck2\">\n                                        Item\n                                </label>\n                                </div>\n                                <div class=\"form-check col-sm-3\">\n                                    <input checked={discountType === 'Bill' && true} onClick={() => setDiscountType('Bill')} class=\"form-check-input\" name=\"discount\" type=\"radio\" value=\"\" id=\"defaultCheck3\" />\n                                    <label class=\"form-check-label\" for=\"defaultCheck3\">\n                                        Bill\n                                </label>\n                                </div>\n                                <div class=\"form-check col-sm-3\">\n                                    <input checked={discountType === 'Both' && true} onClick={() => setDiscountType('Both')} class=\"form-check-input\" name=\"discount\" type=\"radio\" value=\"\" id=\"defaultCheck3\" />\n                                    <label class=\"form-check-label\" for=\"defaultCheck3\">\n                                        Both\n                                </label>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"form-group col-md-2\">\n                        <label for=\"inputPassword\" class=\"col-sm-2 col-form-label\">GST:</label>\n                        <div class=\"d-flex b-0 col-sm-1\">\n                        <input readOnly checked={default_gst} type=\"checkbox\" id=\"inputPassword\" />\n                        </div>\n                        </div>\n                    </div>    \n                    <div class=\"my-4 form-row\">\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"invoice-number\">Item<span className='required-label'>*</span></label>\n                            <Select options={allProducts} value={currentProduct} onChange={(e)=>handleProduct(e)} />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"invoice-number\">Price<span className='required-label'>*</span></label>\n                            <input value={sale_return_price} onChange={(e) => setSaleReturnPrice(e.target.value)} type=\"text\" class=\"form-control\" id=\"\" />\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"invoice-number\">Quantity{currentProduct ? ` (${currentProduct.unit})` :null}<span className='required-label'>*</span></label>\n                            <input value={qty} onChange={e => setQty(e.target.value)} type=\"text\" class=\"form-control\" id=\"\" />\n                        </div>\n                        \n                        {default_gst && <div class=\"form-group col-md-4\">\n                            <label for=\"invoice-number\">GST:<span className='required-label'>*</span></label>\n                            <Select options={gst_list} value={gst} onChange={setGST} />\n                        </div>}\n                        {discountType === 'Item' &&\n                            <div className='form-group col-md-4'>\n                                <label htmlFor=\"\">Discount</label>\n                                <div className='m-0 p-0 col-12 row'>\n                                    <div className=\"px-0 col-5\">\n                                        <input value={discountValue} onChange={e => setDiscountValue(e.target.value)} class=\"form-control\" type=\"text\" name=\"\" id=\"\" />\n                                    </div>\n                                    <div className=\"p-0 col-7\">\n                                        <select value={currentDiscountCriteria} onChange={e => setCurrentDiscountCriteria(e.target.value)} class=\"form-control\" required>\n                                            <option value=\"\">Select Type</option>\n                                            <option value='percent'>Percent</option>\n                                            <option value='amount'>Amount</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>\n                        }\n                        {discountType === 'Both' &&\n                            <div className='form-group col-md-4'>\n                                <label htmlFor=\"\">Discount</label>\n                                <div className='m-0 p-0 col-12 row'>\n                                    <div className=\"px-0 col-5\">\n                                        <input value={discountValue} onChange={e => setDiscountValue(e.target.value)} class=\"form-control\" type=\"text\" name=\"\" id=\"\" />\n                                    </div>\n                                    <div className=\"p-0 col-7\">\n                                        <select value={currentDiscountCriteria} onChange={e => setCurrentDiscountCriteria(e.target.value)} class=\"form-control\" required>\n                                            <option value=\"\">Select Type</option>\n                                            <option value='percent'>Percent</option>\n                                            <option value='amount'>Amount</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>\n                        }\n                        <div class=\"form-group col-md-4 row\">\n                            <div class=\"form-group col-9\">\n                                <label for=\"invoice-number\">Total<span className='required-label'>*</span></label>\n                                <input value={perItemAmount} readOnly type=\"text\" class=\"form-control\" id=\"\" />\n                            </div>\n                            <div class=\"form-group col-3 p-0 purchase-create-mid-plus-img\">\n                                <img className='img-fluid' onClick={() => handleSubmitItem()} style={{ cursor: 'pointer' }} src={plus} alt=\"\" />\n                            </div>\n                        </div>\n                    </div>\n\n                    {allItems.length > 0 && <div className='my-table-responsive'>\n                        <table class=\"table mt-4\">\n                            <thead class=\"thead-dark\">\n                                <tr>\n                                    <th scope=\"col\">Item</th>\n                                    <th scope=\"col\">Price</th>\n                                    <th scope=\"col\">Quantity</th>\n                                    <th scope=\"col\">GST</th>\n                                    <th scope=\"col\">Discount</th>\n                                    <th scope=\"col\">Total</th>\n                                    <th>Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody className='table-borderless'>\n                                {allItems.map((item, index) => {\n                                    return (\n                                        <tr>\n                                            <td>\n                                                <p className='p-0 m-0'>{item.item.label}</p>\n                                                <p>({item.warehouse_name})</p>\n                                            </td>\n                                            <td>{item.sale_return_price}</td>\n                                            <td>{item.qty}</td>\n                                            <td>{item.gst.value}%</td>\n                                            <td>{item.discountValue} {item.discount_type}</td>\n                                            <td>{item.total}</td>\n                                            <td>\n                                                <i style={{ cursor: 'pointer' }} onClick={() => handleEdit(item, index+1)} class=\"fa fa-pencil\" aria-hidden=\"true\"></i>\n                                                <i onClick={() => handleDelete(index)} style={{ cursor: \"pointer\" }} class=\"fa fa-trash\" aria-hidden=\"true\"></i>\n                                            </td>\n                                        </tr>\n                                    )\n                                })}\n                            </tbody>\n                        </table>\n                    </div>}\n                    <div className='row mt-5 justify-content-between purchase-create-footer'>\n                        <div class=\"form-group col-md-5\">\n                            <label for=\"exampleFormControlTextarea1\">Remarks</label>\n                            <textarea value={remarks} onChange={e => setRemarks(e.target.value)} class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"5\"></textarea>\n                        </div>\n                        <div className='col-md-6'>\n                            <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Total Value</label>\n                                <div class=\"col-md-8\">\n                                    <input type=\"text\" value={totalValue} class=\"form-control\" id=\"\" />\n                                </div>\n                            </div>\n                            {discountType === 'Bill' && <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Discount</label>\n                                <div class=\"pr-0 col-md-8 row\">\n                                    <div className=\"pr-0 col-5\">\n                                        <input class=\"form-control\" value={finalDiscountValue} onChange={e => setFinalDiscountValue(e.target.value)} type=\"text\" name=\"\" id=\"\" />\n                                    </div>\n                                    <div className=\"px-0 col-7\">\n                                        <select value={finalDiscountCriteria} onChange={e => setFinalDiscountCriteria(e.target.value)} class=\"form-control\" required>\n                                            <option value=\"\">Select Type</option>\n                                            <option value='percent'>Percent</option>\n                                            <option value='amount'>Amount</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>}\n                            {discountType === 'Both' && <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Discount</label>\n                                <div class=\"pr-0 col-md-8 row\">\n                                    <div className=\"pr-0 col-5\">\n                                        <input class=\"form-control\" type=\"text\" value={finalDiscountValue} onChange={e => setFinalDiscountValue(e.target.value)} />\n                                    </div>\n                                    <div className=\"px-0 col-7\">\n                                        <select value={finalDiscountCriteria} onChange={e => setFinalDiscountCriteria(e.target.value)} class=\"form-control\" required>\n                                            <option value=\"\">Select Type</option>\n                                            <option value='percent'>Percent</option>\n                                            <option value='amount'>Amount</option>\n                                        </select>\n                                    </div>\n                                </div>\n                            </div>}\n                            <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Final Amount</label>\n                                <div class=\"col-md-8\">\n                                    <input readOnly value={finalAmount} type=\"text\" class=\"form-control\" id=\"\" />\n                                </div>\n                            </div>\n                            <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Paid Amount</label>\n                                <div class=\"col-md-8\">\n                                    <input value={paidAmount} type=\"text\" class=\"form-control\" id=\"\" />\n                                </div>\n                            </div>\n                            {paidAmount > 0 && <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Payment Method</label>\n                                <div class=\"col-md-8\">\n                                    <Select options={allPaymentMethods} value={currentPaymentMethod}/>\n                                </div>\n                            </div>}\n                            <div class=\"form-group row\">\n                                <label for=\"\" class=\"col-md-4 col-form-label\">Remain Amount</label>\n                                <div class=\"col-md-8\">\n                                    <input type=\"text\" value={remainAmount} readOnly class=\"form-control\" id=\"\" />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"d-flex justify-content-center create-catagory-btns\">\n                    <button type=\"button\" onClick={() => window.location.reload()} class=\"font-weight-bold m-3 py-2 px-4 btn btn-danger\">Cancel<i\n                        class=\"px-2 fa fa-times\" aria-hidden=\"true\"></i></button>\n                    <button type=\"button\" onClick={()=>finalSubmit()} class=\"font-weight-bold m-3 py-2 px-4 btn btn-success\">Save<i\n                        class=\"px-2 fa fa-floppy-o\" aria-hidden=\"true\"></i></button>\n                </div>\n            </form>\n        </div>\n    )\n}\n"],"sourceRoot":""}